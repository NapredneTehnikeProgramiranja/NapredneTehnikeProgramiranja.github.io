<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="sr" xml:lang="sr">
<head>
<!-- 2018-03-17 Sat 00:08 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Napredne tehnike programiranja - Python</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Novak Boškov" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/bigblow/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/bigblow/css/bigblow.css"/>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/bigblow/css/hideshow.css"/>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery-ui-1.10.2.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.localscroll-min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.scrollTo-1.4.3.1-min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.zclip.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/bigblow.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/hideshow.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Napredne tehnike programiranja - Python</h1>
<div id="table-of-contents">
<h2>Sadr&#382;aj</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgd3a5328">1. Teorija</a></li>
<li><a href="#org740dfa1">2. Napredni Python</a>
<ul>
<li><a href="#org6ebd8ee">2.1. <i>virtualenv</i> i <i>pip</i></a></li>
<li><a href="#org61b87c1">2.2. Iteratori i generatori</a></li>
<li><a href="#orga5d908a">2.3. Ostale specijalne metode</a></li>
<li><a href="#org2404559">2.4. Deskriptiori</a></li>
<li><a href="#orga1724f9">2.5. Dekoratori</a></li>
<li><a href="#orgb3a3d85">2.6. <code>functools</code></a></li>
<li><a href="#org4229080">2.7. <code>itertools</code></a></li>
<li><a href="#org6bb1382">2.8. <i>High performance</i> kolekcije</a></li>
<li><a href="#org58d6eec">2.9. Višestruko nasleđivanje</a></li>
<li><a href="#org335ade0">2.10. Meta klase</a></li>
<li><a href="#orgb0c16a4">2.11. Anotacije funkcija</a></li>
<li><a href="#org10d712c">2.12. MyPy</a></li>
<li><a href="#org87ab1a9">2.13. Zadaci</a></li>
<li><a href="#org7877b35">2.14. Rešenja</a></li>
</ul>
</li>
<li><a href="#org360af5c">3. Parsiranje</a>
<ul>
<li>
<ul>
<li><a href="#org517b25b">3.0.1. Semantika i pragmatika</a></li>
</ul>
</li>
<li><a href="#org07e06ce">3.1. TextX</a></li>
<li><a href="#org15ace07">3.2. Zadaci</a></li>
<li><a href="#orgb56f6e4">3.3. Rešenja</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="figure">
<p><img src="images/python.png" alt="python.png" width="400px" />
</p>
</div>

<blockquote>
<p>
Python is a programming language that lets you work quickly and
integrate systems more effectively.
</p>
</blockquote>

<div id="outline-container-orgd3a5328" class="outline-2">
<h2 id="orgd3a5328"><span class="section-number-2">1</span> Teorija</h2>
<div class="outline-text-2" id="text-1">
<p>
Svi teorijski materijali nalaze se na <a href="http://www.igordejanovic.net/courses/ntp.html">sajtu profesora</a>.
</p>
</div>
</div>

<div id="outline-container-org740dfa1" class="outline-2">
<h2 id="org740dfa1"><span class="section-number-2">2</span> Napredni Python</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org6ebd8ee" class="outline-3">
<h3 id="org6ebd8ee"><span class="section-number-3">2.1</span> <i>virtualenv</i> i <i>pip</i></h3>
<div class="outline-text-3" id="text-2-1">
<p>
Ako Vam koncept <i>virtualenv</i>-a nije poznat pogledajte <a href="https://virtualenv.pypa.io/en/stable/">ovde</a>. Kratak
podsetnik možete naći <a href="http://docs.python-guide.org/en/latest/dev/virtualenvs/">ovde</a>.
</p>
</div>
</div>

<div id="outline-container-org61b87c1" class="outline-3">
<h3 id="org61b87c1"><span class="section-number-3">2.2</span> Iteratori i generatori</h3>
<div class="outline-text-3" id="text-2-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">generator_foo</span>(n):
    <span style="color: #3a81c3; font-weight: bold;">if</span> n &lt; 65 <span style="color: #3a81c3; font-weight: bold;">or</span> n &gt; 90:
        <span style="color: #3a81c3; font-weight: bold;">yield</span> <span style="color: #2d9574;">"Unsupported alphabetical argument"</span>
        <span style="color: #3a81c3; font-weight: bold;">return</span>
    <span style="color: #3a81c3; font-weight: bold;">else</span>:
        <span style="color: #715ab1;">letter</span> = n
        <span style="color: #3a81c3; font-weight: bold;">while</span> letter &lt;= 90:
            <span style="color: #3a81c3; font-weight: bold;">yield</span> <span style="color: #3a81c3;">chr</span>(letter)
            <span style="color: #715ab1;">letter</span> += 1
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">ge</span> = generator_foo(15)
ge.__next__()
ge.__next__()
</pre>
</div>

<pre class="example">
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "/tmp/babel-21303Oss/python-21303Z1C", line 3, in &lt;module&gt;
    ge.__next__()
StopIteration

</pre>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">g1</span> = generator_foo(70)
</pre>
</div>


<div class="org-src-container">
<pre class="src src-python">g1.__next__()
g1.__next__()
g1.__next__()
g1.__next__()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">g2</span> = generator_foo(88)
g2.__next__()
g2.__next__()
g2.__next__()
g2.__next__()
g2.__next__()
</pre>
</div>

<pre class="example">
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "/tmp/babel-21303Oss/python-21303zJP", line 5, in &lt;module&gt;
    g2.__next__()
StopIteration

</pre>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">g3</span> = generator_foo(80)

<span style="color: #3a81c3; font-weight: bold;">for</span> l <span style="color: #3a81c3; font-weight: bold;">in</span> g3:
    <span style="color: #3a81c3; font-weight: bold;">print</span>(l)
</pre>
</div>

<pre class="example">
P
Q
R
S
T
U
V
W
X
Y
Z
</pre>

<p>
A to bi bilo zapravo:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">g3</span> = generator_foo(80)

<span style="color: #715ab1;">iterator_od_g3</span> = g3.__iter__()
<span style="color: #3a81c3; font-weight: bold;">for</span> l <span style="color: #3a81c3; font-weight: bold;">in</span> iterator_od_g3:
    <span style="color: #3a81c3; font-weight: bold;">print</span>(l)
</pre>
</div>

<pre class="example">
P
Q
R
S
T
U
V
W
X
Y
Z
</pre>

<p>
Tako ako hoćemo da implementiramo svoju generatorsku klasu možemo:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">Alphabet</span>:
      <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">__init__</span>(<span style="color: #3a81c3; font-weight: bold;">self</span>, num):
          <span style="color: #3a81c3; font-weight: bold;">self</span>.letter = <span style="color: #3a81c3;">chr</span>(num)
          <span style="color: #3a81c3; font-weight: bold;">self</span>.num = num
      <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">__iter__</span>(<span style="color: #3a81c3; font-weight: bold;">self</span>):
          <span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3; font-weight: bold;">self</span>.num &lt; 65 <span style="color: #3a81c3; font-weight: bold;">or</span> <span style="color: #3a81c3; font-weight: bold;">self</span>.num &gt; 90:
              <span style="color: #3a81c3; font-weight: bold;">yield</span> <span style="color: #ba2f59; font-weight: bold;">Exception</span>
              <span style="color: #3a81c3; font-weight: bold;">return</span>
          <span style="color: #3a81c3; font-weight: bold;">else</span>:
              <span style="color: #3a81c3; font-weight: bold;">for</span> l <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">range</span>(<span style="color: #3a81c3; font-weight: bold;">self</span>.num, 91):
                  <span style="color: #3a81c3; font-weight: bold;">yield</span> Alphabet(l)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">a</span> = Alphabet(85)

<span style="color: #3a81c3; font-weight: bold;">for</span> l <span style="color: #3a81c3; font-weight: bold;">in</span> a:
    <span style="color: #3a81c3; font-weight: bold;">print</span>(l.letter)
</pre>
</div>

<pre class="example">
U
V
W
X
Y
Z

</pre>
</div>
</div>

<div id="outline-container-orga5d908a" class="outline-3">
<h3 id="orga5d908a"><span class="section-number-3">2.3</span> Ostale specijalne metode</h3>
<div class="outline-text-3" id="text-2-3">
<ul class="org-ul">
<li><code>__contains__</code> (in)</li>
<li><code>__getitem__</code> ([])</li>
<li><code>__getattr__</code> i <code>__getattribute__</code></li>
</ul>
</div>
</div>

<div id="outline-container-org2404559" class="outline-3">
<h3 id="org2404559"><span class="section-number-3">2.4</span> Deskriptiori</h3>
</div>

<div id="outline-container-orga1724f9" class="outline-3">
<h3 id="orga1724f9"><span class="section-number-3">2.5</span> Dekoratori</h3>
<div class="outline-text-3" id="text-2-5">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">greet</span>(func):
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">wrapper</span>(arg):
        <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #2d9574;">"Hello "</span> + func(arg)
    <span style="color: #3a81c3; font-weight: bold;">return</span> wrapper

<span style="color: #ba2f59; font-weight: bold;">@greet</span>
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">id</span>(a):
    <span style="color: #3a81c3; font-weight: bold;">return</span> a

<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">greet_side_effect</span>(func):
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">wrapper</span>(arg):
        <span style="color: #3a81c3; font-weight: bold;">print</span>(<span style="color: #2d9574;">"Hello!"</span>)
        <span style="color: #3a81c3; font-weight: bold;">return</span> func(arg)
    <span style="color: #3a81c3; font-weight: bold;">return</span> wrapper

<span style="color: #ba2f59; font-weight: bold;">@greet_side_effect</span>
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">id_side</span>(a):
    <span style="color: #3a81c3; font-weight: bold;">return</span> a + <span style="color: #2d9574;">" students"</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">id</span>(<span style="color: #2d9574;">"all of you!"</span>)
</pre>
</div>

<pre class="example">
'Hello all of you!'

</pre>

<div class="org-src-container">
<pre class="src src-python">id_side(<span style="color: #2d9574;">"Our"</span>)
</pre>
</div>

<pre class="example">
Hello!
'Our students'

</pre>

<p>
Mogu se dekorisati i metode:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">dec</span>(f):
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">w</span>(s, arg):
        <span style="color: #3a81c3; font-weight: bold;">print</span>(<span style="color: #2d9574;">"from dec: %d"</span> % s.a)
        <span style="color: #3a81c3; font-weight: bold;">return</span> f(s, arg)
    <span style="color: #3a81c3; font-weight: bold;">return</span> w

<span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">A</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">__init__</span>(<span style="color: #3a81c3; font-weight: bold;">self</span>, a):
        <span style="color: #3a81c3; font-weight: bold;">self</span>.a = a
    <span style="color: #ba2f59; font-weight: bold;">@dec</span>
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">do_something</span>(<span style="color: #3a81c3; font-weight: bold;">self</span>, arg):
        <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #3a81c3; font-weight: bold;">self</span>.a + arg
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">a</span> = A(1)
a.do_something(2)
</pre>
</div>

<pre class="example">
from dec: 1

</pre>
</div>
</div>

<div id="outline-container-orgb3a3d85" class="outline-3">
<h3 id="orgb3a3d85"><span class="section-number-3">2.6</span> <code>functools</code></h3>
<div class="outline-text-3" id="text-2-6">
<ul class="org-ul">
<li><code>partial</code></li>
<li><code>reduce</code></li>
<li><p>
<code>zip</code>
</p>

<p>
Zip može npr. biti koristan ako od dve liste želimo da napravimo
rečnik:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">a</span> = [<span style="color: #2d9574;">'a'</span>, <span style="color: #2d9574;">'b'</span>, <span style="color: #2d9574;">'c'</span>, <span style="color: #2d9574;">'d'</span>]
<span style="color: #715ab1;">b</span> = [1, 2, 3, 4]

<span style="color: #715ab1;">d</span> = <span style="color: #3a81c3;">dict</span>(<span style="color: #3a81c3;">zip</span>(a, b))
<span style="color: #3a81c3; font-weight: bold;">print</span>(d)

<span style="color: #715ab1;">d2</span> = <span style="color: #3a81c3;">dict</span>(<span style="color: #3a81c3;">zip</span>(b,a))
<span style="color: #3a81c3; font-weight: bold;">print</span>(d2)
</pre>
</div>

<pre class="example">
{'a': 1, 'b': 2, 'c': 3, 'd': 4}
{1: 'a', 2: 'b', 3: 'c', 4: 'd'}

</pre></li>

<li><code>map</code></li>
</ul>
</div>
</div>

<div id="outline-container-org4229080" class="outline-3">
<h3 id="org4229080"><span class="section-number-3">2.7</span> <code>itertools</code></h3>
<div class="outline-text-3" id="text-2-7">
<ul class="org-ul">
<li><p>
<code>chain</code>
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">import</span> itertools <span style="color: #3a81c3; font-weight: bold;">as</span> it

<span style="color: #715ab1;">a</span> = <span style="color: #2d9574;">"abc"</span>
<span style="color: #715ab1;">i</span> = [1, 2, 3]

<span style="color: #3a81c3; font-weight: bold;">for</span> e <span style="color: #3a81c3; font-weight: bold;">in</span> it.chain(a, i):
    <span style="color: #3a81c3; font-weight: bold;">print</span>(e)
</pre>
</div>

<pre class="example">
a
b
c
1
2
3

</pre></li>

<li><p>
<code>takewhile</code>
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">import</span> itertools <span style="color: #3a81c3; font-weight: bold;">as</span> it

<span style="color: #3a81c3; font-weight: bold;">for</span> i <span style="color: #3a81c3; font-weight: bold;">in</span> it.takewhile(<span style="color: #3a81c3; font-weight: bold;">lambda</span> x: x &lt; 10, <span style="color: #3a81c3;">range</span>(1, 20)):
    <span style="color: #3a81c3; font-weight: bold;">print</span>(i)
</pre>
</div>

<pre class="example">
1
2
3
4
5
6
7
8
9

</pre></li>

<li><p>
<code>dropwhile</code> je komplemet od <code>takewhile</code>
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">d</span> = it.dropwhile(<span style="color: #3a81c3; font-weight: bold;">lambda</span> l: l &lt; <span style="color: #2d9574;">'U'</span>, [<span style="color: #3a81c3;">chr</span>(i) <span style="color: #3a81c3; font-weight: bold;">for</span> i <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">range</span>(65, 91)])

<span style="color: #3a81c3; font-weight: bold;">for</span> i <span style="color: #3a81c3; font-weight: bold;">in</span> d:
    <span style="color: #3a81c3; font-weight: bold;">print</span>(i)
</pre>
</div>

<pre class="example">
U
V
W
X
Y
Z

</pre></li>

<li><code>groupby</code></li>
</ul>
</div>
</div>

<div id="outline-container-org6bb1382" class="outline-3">
<h3 id="org6bb1382"><span class="section-number-3">2.8</span> <i>High performance</i> kolekcije</h3>
<div class="outline-text-3" id="text-2-8">
<ul class="org-ul">
<li><p>
<code>deque</code>
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">from</span> time <span style="color: #3a81c3; font-weight: bold;">import</span> time
<span style="color: #3a81c3; font-weight: bold;">from</span> collections <span style="color: #3a81c3; font-weight: bold;">import</span> deque

<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">timed</span>(f):
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">w</span>():
        <span style="color: #715ab1;">bg</span> = time()
        f()
        <span style="color: #715ab1;">en</span> = time()
        <span style="color: #3a81c3; font-weight: bold;">print</span>(<span style="color: #2d9574;">"time elapsed : "</span> + <span style="color: #3a81c3;">str</span>(en - bg))
    <span style="color: #3a81c3; font-weight: bold;">return</span> w

<span style="color: #715ab1;">small</span> = 10
<span style="color: #715ab1;">large</span> = <span style="color: #3a81c3;">int</span>(10e6)
<span style="color: #715ab1;">l_small</span> = <span style="color: #3a81c3;">list</span>(<span style="color: #3a81c3;">range</span>(small))
<span style="color: #715ab1;">l_large</span> = <span style="color: #3a81c3;">list</span>(<span style="color: #3a81c3;">range</span>(large))
<span style="color: #715ab1;">d_small</span> = deque(<span style="color: #3a81c3;">range</span>(small))
<span style="color: #715ab1;">d_large</span> = deque(<span style="color: #3a81c3;">range</span>(large))

<span style="color: #ba2f59; font-weight: bold;">@timed</span>
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">a_list</span>():
    l_small.pop()

<span style="color: #ba2f59; font-weight: bold;">@timed</span>
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">a_larger_list</span>():
    l_large.pop()

<span style="color: #ba2f59; font-weight: bold;">@timed</span>
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">a_deque</span>():
    d_small.pop()

<span style="color: #ba2f59; font-weight: bold;">@timed</span>
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">a_larger_deque</span>():
    d_large.pop()

a_list()
a_larger_list()
a_deque()
a_larger_deque()
</pre>
</div>

<pre class="example">

time elapsed : 2.384185791015625e-06
time elapsed : 1.6689300537109375e-06
time elapsed : 1.1920928955078125e-06
time elapsed : 1.1920928955078125e-06

</pre></li>
</ul>
</div>
</div>

<div id="outline-container-org58d6eec" class="outline-3">
<h3 id="org58d6eec"><span class="section-number-3">2.9</span> Višestruko nasleđivanje</h3>
</div>

<div id="outline-container-org335ade0" class="outline-3">
<h3 id="org335ade0"><span class="section-number-3">2.10</span> Meta klase</h3>
</div>

<div id="outline-container-orgb0c16a4" class="outline-3">
<h3 id="orgb0c16a4"><span class="section-number-3">2.11</span> Anotacije funkcija</h3>
<div class="outline-text-3" id="text-2-11">
<p>
Funkcijama u Python-u <b>&gt;=3</b> se mogu davati opcione <a href="https://www.python.org/dev/peps/pep-3107/">anotacije</a> za
parametre i povratne vrednosti. Anotacije su izrazi koji se
izvršavaju u <i>compile time</i>-u. Ti izrazi nemaju nikakvu unapred
određenu ulogu već njihovo značenje može da dopuni neka biblioteka.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">annot_foo</span>(a: 1 + 2, b: <span style="color: #2d9574;">"this "</span> + <span style="color: #2d9574;">"is b."</span>) -&gt; <span style="color: #3a81c3;">len</span>([1, 2, 3]):
    <span style="color: #3a81c3; font-weight: bold;">pass</span>
</pre>
</div>

<p>
Pošto kao anotacije možete da stavite bilo kakav izraz to znači da
u vreme kompajliranja funkcije (učitavanja u Python interpreter)
možete da izazovete sporedni efekat:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">a</span> = 1

<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">mutator</span>():
    <span style="color: #3a81c3; font-weight: bold;">global</span> a
    <span style="color: #715ab1;">a</span> += 1

<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">foo</span>(a: mutator()):
    <span style="color: #3a81c3; font-weight: bold;">pass</span>

<span style="color: #3a81c3; font-weight: bold;">print</span>(a)
</pre>
</div>

<pre class="example">
2

</pre>

<p>
Anotacije su dostupne kroz objekat funkcije kao mutabilan rečnik:
</p>

<div class="org-src-container">
<pre class="src src-python">annot_foo.__annotations__
</pre>
</div>

<pre class="example">
{'a': 3, 'b': 'this is b.', 'return': 3}

</pre>
</div>
</div>

<div id="outline-container-org10d712c" class="outline-3">
<h3 id="org10d712c"><span class="section-number-3">2.12</span> MyPy</h3>
<div class="outline-text-3" id="text-2-12">
<p>
Python je dinamički tipiziran programski jezik. <a href="http://mypy-lang.org/">MyPy</a> je opcioni
statički <i>type checker</i> za Python. Ako želite da ispitate tipove u
Python-u pre nego što se program izvrši to možete da uradite
koristeći MyPy.
</p>

<p>
MyPy se oslanja na anotacije koje su podržane od Python-a 3.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">loud_greetings</span>(name: <span style="color: #3a81c3;">str</span>) -&gt; <span style="color: #3a81c3;">str</span>:
    <span style="color: #3a81c3; font-weight: bold;">return</span> 1
<span style="color: #2aa1ae; background-color: #ecf3ec;"># </span><span style="color: #2aa1ae; background-color: #ecf3ec;">^^^ Incompatible return value type (got "int", expected "str")</span>

<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">loud_greetings_two</span>(name: <span style="color: #3a81c3;">str</span>) -&gt; <span style="color: #3a81c3;">str</span>:
    <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #2d9574;">"Hello World!"</span>

<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">mypy_example</span>() -&gt; <span style="color: #4e3163;">None</span>:
    <span style="color: #2aa1ae; background-color: #ecf3ec;"># </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Ovako override-ujemo type inference</span>
    <span style="color: #715ab1;">a</span> = 2 <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">type: float</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">### </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Kinds</span>

<span style="color: #3a81c3; font-weight: bold;">from</span> typing <span style="color: #3a81c3; font-weight: bold;">import</span> Tuple
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">mypy_k1</span>(a: <span style="color: #3a81c3;">int</span>) -&gt; Tuple[<span style="color: #3a81c3;">str</span>, <span style="color: #3a81c3;">int</span>]:
    <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #2d9574;">'prvi'</span>, a

<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">mypy_k2</span>(a: <span style="color: #3a81c3;">int</span>) -&gt; Tuple[<span style="color: #3a81c3;">str</span>, <span style="color: #3a81c3;">int</span>]:
    <span style="color: #3a81c3; font-weight: bold;">return</span> a, a
<span style="color: #2aa1ae; background-color: #ecf3ec;"># </span><span style="color: #2aa1ae; background-color: #ecf3ec;">^^^ Incompatible return value type (got "Tuple[int, int]", expected "Tuple[str</span><span style="color: #6c4173; background-color: #ecf3ec;">, int]")</span>

<span style="color: #3a81c3; font-weight: bold;">from</span> typing <span style="color: #3a81c3; font-weight: bold;">import</span> Iterator
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">mypy_iterator</span>() -&gt; Iterator[<span style="color: #3a81c3;">int</span>]:
    <span style="color: #715ab1;">i</span> = 0
    <span style="color: #3a81c3; font-weight: bold;">while</span> <span style="color: #4e3163;">True</span>:
        <span style="color: #3a81c3; font-weight: bold;">yield</span> i
        <span style="color: #715ab1;">i</span> += 1
</pre>
</div>
</div>
</div>

<div id="outline-container-org87ab1a9" class="outline-3">
<h3 id="org87ab1a9"><span class="section-number-3">2.13</span> Zadaci</h3>
<div class="outline-text-3" id="text-2-13">
<ol class="org-ol">
<li>Napraviti klasu <code>GithubUser</code> čiji svaki objekat pri konstrukciji
dobija ime, prezime i login podatke za <i>GitHub</i>. Iteriranjem
kroz korisnika se dobijaju korisnici koje dati korisnik
prati. Koristite <a href="https://github.com/PyGithub/PyGithub">pygithub</a> za komunikaciju sa <i>GitHub</i>-om.</li>
<li>Neka klasa ima i metodu <code>peek</code> koja vraća generator kroz koji
kada iteriramo dobijamo jedno po jedno ime repozitorijuma koje
je <code>GithubUser</code> označio zvezdicom.</li>
<li>Dodati <code>GithubUser</code> klasi polje <code>more_info</code> koje je rečnik sa
podacima <code>nf_follower</code> (ime prvog pratioca), <code>nf_watched</code> (ime
prvog <i>watched</i> repozitorijuma). Omogućiti da se imenu prvog
repozitorijuma pristupa sa <code>gu.nf_watched</code>.</li>
<li>Implementirati poređenje <code>GithubUser</code>-a tako da je "veći" onaj
koji ima više pratilaca.</li>
<li>Dekorisati metodu <code>peek</code> dekoratorom koji loguje(ispisuje) email
<code>GithubUser</code>-a u fajl.</li>
<li>Koristeći funkciju <code>reduce</code> napravite string oblika <code>"p1, p2, p3
      ..."</code> gde su <code>p</code> imena svih pratilaca <code>GithubUser</code>.</li>
<li>Koristeći funkciju <code>filter</code> napraviti metodu <code>GithubUser</code>-a koja
vraća imena repozitorijuma označenih zvezdicom koji su napisani
u Python-u (napisanim u Python-u se smatraju svi repozitorijumi
koji u <code>repo.get_languages()</code> imaju ključ "Python").</li>
<li>Koristeći funkciju <code>map</code> napraviti metodu <code>plain_repos</code>
<code>GithubUsere</code>-a koja vraća listu imena svih njegovih
repozitorijuma ali bez korisničkog imena na
početku(repozitorijumi su inače oblika <code>user_name/repo_name</code>).</li>
<li>Napraviti metodu <code>endless_repos</code> <code>GithubUser</code>-a koja vraća
beskrajni iterator na sve repozitorijume koje korisnik prati
koristeći njegovu <code>self.__iter__</code> metodu.</li>
</ol>
</div>
</div>

<div id="outline-container-org7877b35" class="outline-3">
<h3 id="org7877b35"><span class="section-number-3">2.14</span> Rešenja</h3>
<div class="outline-text-3" id="text-2-14">
<ol class="org-ol">
<li><p>
<code>get_followers</code>
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">from</span> github <span style="color: #3a81c3; font-weight: bold;">import</span> Github

<span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">GithubUser</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">__init__</span>(<span style="color: #3a81c3; font-weight: bold;">self</span>, name, surname, username, paswd=<span style="color: #4e3163;">None</span>):
        <span style="color: #3a81c3; font-weight: bold;">self</span>.name = name
        <span style="color: #3a81c3; font-weight: bold;">self</span>.surname = surname
        <span style="color: #3a81c3; font-weight: bold;">self</span>.username = username
        <span style="color: #3a81c3; font-weight: bold;">self</span>.paswd = paswd
        <span style="color: #3a81c3; font-weight: bold;">self</span>.gh_user = Github(username, paswd <span style="color: #3a81c3; font-weight: bold;">or</span> <span style="color: #3a81c3; font-weight: bold;">self</span>.get_pass()).get_user()
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">__iter__</span>(<span style="color: #3a81c3; font-weight: bold;">self</span>):
        <span style="color: #3a81c3; font-weight: bold;">for</span> fl <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3; font-weight: bold;">self</span>.gh_user.get_followers():
            <span style="color: #3a81c3; font-weight: bold;">yield</span> fl
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">get_pass</span>(<span style="color: #3a81c3; font-weight: bold;">self</span>):
        <span style="color: #3a81c3; font-weight: bold;">with</span> <span style="color: #3a81c3;">open</span>(<span style="color: #2d9574;">'/home/novak/Desktop/pass.github'</span>, <span style="color: #2d9574;">'r'</span>) <span style="color: #3a81c3; font-weight: bold;">as</span> f:
            <span style="color: #3a81c3; font-weight: bold;">return</span> f.readline().strip()
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">peek</span>(<span style="color: #3a81c3; font-weight: bold;">self</span>):
        <span style="color: #3a81c3; font-weight: bold;">for</span> repo <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3; font-weight: bold;">self</span>.gh_user.get_starred():
            <span style="color: #3a81c3; font-weight: bold;">yield</span> repo.full_name
</pre>
</div>

<pre class="example">
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "/tmp/babel-21303Oss/python-21303OYu", line 1, in &lt;module&gt;
    from github import Github
ModuleNotFoundError: No module named 'github'

</pre>

<div class="org-src-container">
<pre class="src src-python">[u.login <span style="color: #3a81c3; font-weight: bold;">for</span> u <span style="color: #3a81c3; font-weight: bold;">in</span> GithubUser(<span style="color: #2d9574;">'Novak'</span>, <span style="color: #2d9574;">'Boskov'</span>, <span style="color: #2d9574;">'novakboskov'</span>)]
</pre>
</div>

<pre class="example">
['MihailoIsakov', 'danielkupco', 'cusspvz', 'angusshire', 'mbejn', 'igordejanovic', 'amittendulkar', 'coka', 'strika', 'MilosSimic', 'AleksandarRakic', 'nikoladakic', 'C0mpy', 'Mijura', 'stefanplazic', 'yalu']

</pre>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">for</span> r <span style="color: #3a81c3; font-weight: bold;">in</span> GithubUser(<span style="color: #2d9574;">'Novak'</span>, <span style="color: #2d9574;">'Boskov'</span>, <span style="color: #2d9574;">'novakboskov'</span>).peek():
    <span style="color: #3a81c3; font-weight: bold;">print</span>(r)
</pre>
</div>

<pre class="example">

... bscarlet/llvm-general
commercialhaskell/stack
alwx/luno-react-native
status-im/status-react
diagrams/diagrams-lib
adamgundry/ghc-proposals
mrkkrp/ebal
haskell/cabal
ghc/ghc
davidbrewer/xmonad-ubuntu-conf
vicfryzel/xmonad-config
haskell/ThreadScope
dmatveev/shampoo-emacs
facebook/Haxl
haskell/c2hs
agda/agda
cisco/ChezScheme
emacsfodder/move-text
Wilfred/remacs
clash-lang/clash-compiler
retro/graphql-builder
vermiculus/magithub
skeeto/emacsql
defunkt/coffee-mode
...
</pre></li>

<li><code>reduce(lambda a, n: a + str(n.name) + ",", nb.get_followers(), "")</code></li>
<li><code>itertools.cycle</code></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org360af5c" class="outline-2">
<h2 id="org360af5c"><span class="section-number-2">3</span> Parsiranje</h2>
<div class="outline-text-2" id="text-3">
<p>
Kako bismo razumeli kontekst parsiranja i njegov značaj nije zgoreg
podsetiti se šta čini <b>jezik</b>. Pojam <b>jezika</b> uzmimo generalno i
intuitivno, bez definicije. Formalno određenje pojma jezika duboko
je u realmu lingvistike, a ne čini se sasvim prosto.
</p>

<p>
Jezik je sačinjen iz delova:
</p>

<ul class="org-ul">
<li><i>Fonologija</i>, sistem zvukova koji čine jezik</li>
<li><i>Morfologija</i>, struktura rači</li>
<li><b>Sintaksa</b>, struktura rečenice</li>
<li><i>Semantika</i>, značenje jezika</li>
<li><i>Pragmatika</i>, pravilno korišćenje jezika u različitim kontekstima</li>
</ul>

<p>
Kada govorimo o programskim jezicima Fonologiju možemo zanemariti
(neka svako čita kod na glas kako mu je volja). Ako snažno zažmurimo
na jedno oko možemo zanemariti i Morfologiju (neki jezici koriste
<code>def</code> kao ključnu reč za funkciju, neki <code>defn</code>, neki <code>def</code>, neki
ništa, recimo da je sve to OK).
</p>

<p>
Međutim, ako bismo hteli da zanemarimo sintaksu programskog jezika
morali bismo prilično snažno da žmurimo na oba oka.
</p>

<p>
<a href="https://en.wikipedia.org/wiki/Parsing">Parsiranje</a> je proces analize jezika (kao teksta) prema formalnim
sintaksnim pravilima (gramatikama, kada su u putanju programski
jezici ova dva termina se često koriste u istom značenju) koje za
rezultat ima jedno ili više <a href="https://en.wikipedia.org/wiki/Parse_tree">stabala parsiranja</a> koja predstavljaju
sintaktičke strukture analiziranog jezika.
</p>


<div class="figure">
<p><img src="images/parser.jpg" alt="parser.jpg" />
</p>
</div>
</div>

<div id="outline-container-org517b25b" class="outline-4">
<h4 id="org517b25b"><span class="section-number-4">3.0.1</span> Semantika i pragmatika</h4>
<div class="outline-text-4" id="text-3-0-1">
<blockquote>
<p>
<b>Semantika</b> je značenje jezika.
</p>
</blockquote>

<p>
Prosto, postoje objašnjenja koja su kratka i genijalna!
</p>

<p>
<i>Ali ovo objašnjenje je samo kratko.</i>
</p>

<p>
Ako obratite pažnju, videćete da pojam <b>značenje</b> u rečenici
"semantika je značenje jezika" ne znači mnogo. Programski jezik
<i>znači nešto programeru</i> i <i>znači nešto mašini</i>. Ta dva značenja
se bitno razlikuju jer se misaoni procesi bliski čoveku i oni
bliski mašini razlikuju. Vrlo grubo rečeno:
</p>

<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/Operational_semantics">Operaciona semantika</a> je značenje pri izvršavanju</li>
<li><a href="https://en.wikipedia.org/wiki/Denotational_semantics">Denotaciona semantika</a> je značenje u apstraktnom modelu koji
usvaja čovek kao alat za rešavanje problema koji je pred
njim. Taj apstraktni model se opisuje striktno matematički.</li>
</ul>

<p>
Pragmatika, na kraju, se brine koliko je izražavanje čoveka
(programera u našem slučaju) prirodno u odnosu na preslikavanje
prirode u apstrakti model koji se koristi. Kada je program izražen
prirodno, u skladu sa apstraktnim modelom, kažemo da je
<i>idiomatičan</i>.
</p>
</div>
</div>

<div id="outline-container-org07e06ce" class="outline-3">
<h3 id="org07e06ce"><span class="section-number-3">3.1</span> TextX</h3>
<div class="outline-text-3" id="text-3-1">
<p>
<a href="https://github.com/igordejanovic/textX">TextX</a> (pogledati primire) je Python meta jezik za definisanje
jezika inspirisan <a href="http://www.eclipse.org/Xtext/">XText</a>-om.
</p>
</div>
</div>

<div id="outline-container-org15ace07" class="outline-3">
<h3 id="org15ace07"><span class="section-number-3">3.2</span> Zadaci</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Dato je parče koda u čudnom programskom jeziku <b>Plisp</b>.
</p>

<p>
<a id="org93f713c"></a>
</p>
<div class="org-src-container">
<pre class="src src-python">(<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">hello_number</span> (a b)
  (let [v (* (let [a b]
                  c)
             12)]
       (<span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">"Hello "</span> (+ a b))))

(<span style="color: #3a81c3;">apply</span> hello_number 1 2)

(<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">say_hello_to_hello</span> ()
  <span style="color: #2d9574;">"Ay yo!"</span>)

(<span style="color: #3a81c3;">apply</span> say_hello_to_hello)

(<span style="color: #3a81c3;">apply</span> hello_number
       (let [a (<span style="color: #3a81c3;">apply</span> say_hello_to_hello)
             b <span style="color: #2d9574;">"it's also able to hell o!"</span>]
             (let [s (* a b)]
                  (+ a b s)))
       2)

(<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">sum_two</span> (f s)
  (+ f s))

(let [m 12
      n 18]
     (<span style="color: #3a81c3;">apply</span> sum_two m n))

<span style="color: #2d9574;">"Po ovoj gramatici mo&#382;e i ovo:"</span>
43
23.0
0
</pre>
</div>

<p>
U istom tom programskom jeziku napisan je i program koji na
internetu ume da pronađe besplatne kupone za doživotnu kućnu
dostavu <i>Index sendviča</i>&trade;.
</p>

<p>
Svi vole <i>Index sendviče</i>&trade;.
</p>

<p>
Međutim, tu je i jedan problem. Program je procureo u javnost u
nedovršenoj verziji i Vi treba da ga dovršite.
</p>

<p>
Međutim i tu ima jedan problem. Program je toliko poverljiv da čak
ne postoji ni <i>tooling</i> za njegov programski jezik. Kako biste
počeli da radite na programu prvo morate sebi da napravite razvojno
okruženje. Za početak će biti dovoljna statička analiza.
</p>

<p>
Napišite parser za <b>Plisp</b> koristeći <a href="#org07e06ce">TextX</a>, a potom napravite
Python program sa funkcijom <code>spot_lets</code> kojoj prosledite <a href="#org07e06ce">TextX</a>
model programa a on Vam vrati listu koja ukazuje na kojim
pozicijama u programu se nalaze <code>let</code> izrazi. Funkcija <code>spot_lets</code>
za program <a href="#org93f713c">gore</a> treba da vrati:
</p>

<div class="org-src-container">
<pre class="src src-python">[([<span style="color: #2d9574;">'v'</span>], (2, 4)),
 ([<span style="color: #2d9574;">'a'</span>], (2, 15)),
 ([<span style="color: #2d9574;">'a'</span>, <span style="color: #2d9574;">'b'</span>], (15, 9)),
 ([<span style="color: #2d9574;">'s'</span>], (17, 15)),
 ([<span style="color: #2d9574;">'m'</span>, <span style="color: #2d9574;">'n'</span>], (24, 2))]
</pre>
</div>

<p>
Što znači da program ima dve <code>let</code> naredbe na liniji 2, koloni 4 (i
u tom <code>let</code>-u <i>binding</i> za simbol <code>v</code>) i po jednu na linijama 15,
17, 24.
</p>
</div>
</div>

<div id="outline-container-orgb56f6e4" class="outline-3">
<h3 id="orgb56f6e4"><span class="section-number-3">3.3</span> Rešenja</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Gramatika jezika je data sa:
</p>

<div class="org-src-container">
<pre class="src src-textx">Program: expressions<span style="color: #3a81c3; font-weight: bold;">*=</span>Expression;
Expression: Basic_Expression | S_Expression;
Basic_Expression: val<span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #ba2f59; font-weight: bold;">BASETYPE</span>;
S_Expression: <span style="color: #2d9574;">'('</span> exp<span style="color: #3a81c3; font-weight: bold;">=</span>Exp <span style="color: #2d9574;">')'</span>;
Exp: DefExpression | PrintExpression | ArithExpression | LetExpression | ApplyEx<span style="color: #6c4173;">p;</span>
LetExpression: <span style="color: #2d9574;">'let'</span> <span style="color: #2d9574;">'['</span> bind_form<span style="color: #3a81c3; font-weight: bold;">+=</span>BindForm <span style="color: #2d9574;">']'</span> exp<span style="color: #3a81c3; font-weight: bold;">*=</span>Expression;
BindForm: name<span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #ba2f59; font-weight: bold;">ID</span> exp<span style="color: #3a81c3; font-weight: bold;">=</span>Expression;
PrintExpression: <span style="color: #2d9574;">'print'</span> to_print<span style="color: #3a81c3; font-weight: bold;">+=</span>Expression;
ArithExpression: Sum | Product;
DefExpression: <span style="color: #2d9574;">'def'</span> name<span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #ba2f59; font-weight: bold;">ID</span> <span style="color: #2d9574;">'('</span> args<span style="color: #3a81c3; font-weight: bold;">*=</span>Arg <span style="color: #2d9574;">')'</span> body<span style="color: #3a81c3; font-weight: bold;">*=</span>Expression;
ApplyExp: <span style="color: #2d9574;">'apply'</span> f_name<span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #ba2f59; font-weight: bold;">ID</span> f_params<span style="color: #3a81c3; font-weight: bold;">*=</span>Expression;
Arg: <span style="color: #ba2f59; font-weight: bold;">ID</span>;
Sum: (<span style="color: #2d9574;">'+'</span>|<span style="color: #2d9574;">'-'</span>) exp<span style="color: #3a81c3; font-weight: bold;">+=</span>Expression;
Product: <span style="color: #2d9574;">'*'</span> exp<span style="color: #3a81c3; font-weight: bold;">+=</span>Expression;
</pre>
</div>

<p>
Ovo možemo vizualizovati korišćenjem TextX-a i <a href="http://www.graphviz.org/">GraphViz</a>-a:
</p>

<div class="org-src-container">
<pre class="src src-shell">$ textx visualize plisp.tx
...
$ dot -Tpng -O plisp.tx.dot
</pre>
</div>


<div class="figure">
<p><img src="images/plisp.tx.dot.png" alt="plisp.tx.dot.png" width="700px" />
</p>
</div>

<p>
Takođe možemo vizualizovati i <a href="http://www.igordejanovic.net/textX/tutorials/robot/#interpreting-model">mogram</a>:
</p>

<div class="org-src-container">
<pre class="src src-shell">$ textx visualize plisp.tx example.plisp
...
$ dot -Tpng -O example.plisp.dot
</pre>
</div>


<div class="figure">
<p><img src="images/example.plisp.dot.png" alt="example.plisp.dot.png" width="700px" />
</p>
</div>

<p>
U nastavku je data jedna implementacija funkcije <code>spot_lets</code>. S
obzirom da je gramatika rekurzivna i ovaj problem je opisan
rekurzivno. Pogledajte kako funkcija <code>spot_lets_single_exp</code> poziva
<code>spot_lets</code> i obrnuto, ovo ze naziva <a href="https://en.wikipedia.org/wiki/Mutual_recursion">međusobna rekurzija</a> (što je
vrsta <a href="https://en.wikipedia.org/wiki/Recursion_(computer_science)#Indirect_recursion">indirektne rekurzije</a>).
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">from</span> textx.metamodel <span style="color: #3a81c3; font-weight: bold;">import</span> metamodel_from_file
<span style="color: #3a81c3; font-weight: bold;">from</span> collections <span style="color: #3a81c3; font-weight: bold;">import</span> Iterable
<span style="color: #3a81c3; font-weight: bold;">from</span> functools <span style="color: #3a81c3; font-weight: bold;">import</span> <span style="color: #3a81c3;">reduce</span>

<span style="color: #715ab1;">mm</span> = metamodel_from_file(<span style="color: #2d9574;">"plisp.tx"</span>)
<span style="color: #715ab1;">m</span> = mm.model_from_file(<span style="color: #2d9574;">"example.plisp"</span>)

<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">gn_Program</span>(e): <span style="color: #3a81c3; font-weight: bold;">return</span> e.expressions
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">gn_Basic_Expression</span>(e): <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #4e3163;">None</span>
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">gn_S_Expression</span>(e): <span style="color: #3a81c3; font-weight: bold;">return</span> e.exp
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">gn_BindForm</span>(e): <span style="color: #3a81c3; font-weight: bold;">return</span> e.exp

<span style="color: #715ab1;">gn_options</span> = {<span style="color: #2d9574;">'Basic_Expression'</span>: gn_Basic_Expression,
              <span style="color: #2d9574;">'S_Expression'</span>:     gn_S_Expression}

<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">gn_LetExpression</span>(e):
    <span style="color: #715ab1;">bfs</span> = [gn_BindForm(bf) <span style="color: #3a81c3; font-weight: bold;">for</span> bf <span style="color: #3a81c3; font-weight: bold;">in</span> e.bind_form]
    <span style="color: #715ab1;">exs</span> = [gn_options[ex.__class__.<span style="color: #3a81c3;">__name__</span>](ex) <span style="color: #3a81c3; font-weight: bold;">for</span> ex <span style="color: #3a81c3; font-weight: bold;">in</span> e.exp]
    <span style="color: #3a81c3; font-weight: bold;">return</span> bfs + exs

<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">gn_PrintExpression</span>(e): <span style="color: #3a81c3; font-weight: bold;">return</span> e.to_print
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">gn_DefExpression</span>(e): <span style="color: #3a81c3; font-weight: bold;">return</span> e.body
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">gn_ApplyExp</span>(e): <span style="color: #3a81c3; font-weight: bold;">return</span> e.f_params
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">gn_Sum</span>(e): <span style="color: #3a81c3; font-weight: bold;">return</span> e.exp
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">gn_Product</span>(e): <span style="color: #3a81c3; font-weight: bold;">return</span> e.exp

gn_options.update({<span style="color: #2d9574;">'Program'</span>:          gn_Program,
                   <span style="color: #2d9574;">'LetExpression'</span>:    gn_LetExpression,
                   <span style="color: #2d9574;">'BindForm'</span>:         gn_BindForm,
                   <span style="color: #2d9574;">'PrintExpression'</span>:  gn_PrintExpression,
                   <span style="color: #2d9574;">'DefExpression'</span>:    gn_DefExpression,
                   <span style="color: #2d9574;">'ApplyExp'</span>:         gn_ApplyExp,
                   <span style="color: #2d9574;">'Sum'</span>:              gn_Sum,
                   <span style="color: #2d9574;">'Product'</span>:          gn_Product})

<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">get_next_exps</span>(e):
    <span style="color: #da8b55;">"""Return all successor expressions of a given expression."""</span>
    <span style="color: #3a81c3; font-weight: bold;">return</span> gn_options[e.__class__.<span style="color: #3a81c3;">__name__</span>](e)

<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">is_let</span>(exp):
    <span style="color: #3a81c3; font-weight: bold;">return</span> exp.__class__.<span style="color: #3a81c3;">__name__</span> == <span style="color: #2d9574;">'LetExpression'</span>

<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">get_all_let_bindings</span>(l):
    <span style="color: #da8b55;">"""Extract all bindings from let."""</span>
    <span style="color: #3a81c3; font-weight: bold;">return</span> [b.name <span style="color: #3a81c3; font-weight: bold;">for</span> b <span style="color: #3a81c3; font-weight: bold;">in</span> l.bind_form]

<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">spot_lets_single_exp</span>(e, lets=[]):

    <span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3; font-weight: bold;">not</span> e: <span style="color: #3a81c3; font-weight: bold;">return</span> lets

    <span style="color: #3a81c3; font-weight: bold;">if</span> is_let(e):
        <span style="color: #715ab1;">pos</span> =  mm.parser.pos_to_linecol(e._tx_position)
        <span style="color: #3a81c3; font-weight: bold;">return</span> spot_lets(get_next_exps(e), \
                         lets + [(get_all_let_bindings(e), pos)])
    <span style="color: #3a81c3; font-weight: bold;">else</span>:
        <span style="color: #3a81c3; font-weight: bold;">return</span> spot_lets(get_next_exps(e), lets)

<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">spot_lets</span>(e, lets=[]):
    <span style="color: #da8b55;">"""Spot all the let expressions in the program. Return list of tuples</span>
<span style="color: #da8b55;">       ([bind_variable+], position_of_let_expression). """</span>

    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">reducer</span>(ls, ex):
        <span style="color: #3a81c3; font-weight: bold;">return</span> ls + (spot_lets_single_exp(ex) <span style="color: #3a81c3; font-weight: bold;">or</span> [])

    <span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3;">isinstance</span>(e, Iterable):
        <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #3a81c3;">reduce</span>(reducer, e, lets)
    <span style="color: #3a81c3; font-weight: bold;">else</span>:
        <span style="color: #3a81c3; font-weight: bold;">return</span> spot_lets_single_exp(e, lets)

<span style="color: #3a81c3; font-weight: bold;">print</span>(spot_lets(m))
<span style="color: #2aa1ae; background-color: #ecf3ec;"># </span><span style="color: #2aa1ae; background-color: #ecf3ec;">[(['v'], (2, 4)),</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#  </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(['a'], (2, 15)),</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#  </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(['a', 'b'], (15, 9)),</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#  </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(['s'], (17, 15)),</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#  </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(['m', 'n'], (24, 2))]</span>
</pre>
</div>

<p>
Python "nije baš srećan sa rekurzijom" i za to postoji <a href="http://stackoverflow.com/questions/26873627/why-does-python-have-a-maximum-recursion-depth">više razloga</a>
a jedan od njih je što nema podržan <a href="https://en.wikipedia.org/wiki/Tail_call">tail call optimization</a> (na ovom
kursu ćete upoznati i programske jezike u kojima je rekurzija
poželjna i podržana).
</p>

<p>
Ali bez brige, sam TextX ima mehanizam kojim možemo vrlo elegantno
da rešimo problem iz ovog zadatka i njemu slične.
</p>

<p>
Mehanizam koji nam je ovde od interesa u TextX-u se zove <a href="http://www.igordejanovic.net/textX/metamodel/#object-processors">object
processori</a>. Funkcije koje registrujete za <i>object processore</i> se
pozivaju u vreme kada TextX instancira klase pravila iz gramatike
(a to se desi kada se u tekstu naiđe na pravilo). Dakle, sve se ovo
dešava "u letu" tj. za pronalaženje <code>let</code> izraza se koristi
TextX-ov prolaz parsiranja za razliku od prethodnog rešenja u kome
mi "ručno" obilazimo stablo nakon što ga je TextX već jednom
obišao.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">from</span> textx.metamodel <span style="color: #3a81c3; font-weight: bold;">import</span> metamodel_from_file

<span style="color: #715ab1;">lets</span> = []

<span style="color: #715ab1;">mm</span> = metamodel_from_file(<span style="color: #2d9574;">"plisp.tx"</span>)

<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">let_object_processor</span>(let):
    lets.append(([b.name <span style="color: #3a81c3; font-weight: bold;">for</span> b <span style="color: #3a81c3; font-weight: bold;">in</span> let.bind_form],
                 mm.parser.pos_to_linecol(let._tx_position)))

mm.register_obj_processors({<span style="color: #2d9574;">'LetExpression'</span>: let_object_processor})

<span style="color: #715ab1;">m</span> = mm.model_from_file(<span style="color: #2d9574;">"example.plisp"</span>)

<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">spot_lets</span>():
    <span style="color: #3a81c3; font-weight: bold;">return</span> lets

<span style="color: #3a81c3; font-weight: bold;">print</span>(spot_lets())
<span style="color: #2aa1ae; background-color: #ecf3ec;"># </span><span style="color: #2aa1ae; background-color: #ecf3ec;">[(['a'], (2, 15)),</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#  </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(['v'], (2, 4)),</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#  </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(['s'], (17, 15)),</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#  </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(['a', 'b'], (15, 9)),</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#  </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(['m', 'n'], (24, 2))]</span>
</pre>
</div>

<p>
Redosled u rezultujućoj listi zavisi od redosleda obilaska stabla a
to je različito u dva predstavljena rešenja.
</p>

<p>
Ovo je svakako način na koji biste ovaj zadatak rešili ako biste
imali TextX na raspolaganju. Rešenje sa "ručnim obilaskom" stabla
ilustruje opšti pristup.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Novak Boškov</p>
<p class="date">Created: 2018-03-17 Sat 00:08</p>
<p class="validation"></p>
</div>
</body>
</html>
