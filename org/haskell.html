<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="sr" xml:lang="sr">
<head>
<!-- 2017-05-25 чет 13:24 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Napredne tehnike programiranja - Haskell</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Novak Boškov" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/bigblow/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/bigblow/css/bigblow.css"/>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/bigblow/css/hideshow.css"/>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery-ui-1.10.2.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.localscroll-min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.scrollTo-1.4.3.1-min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.zclip.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/bigblow.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/hideshow.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2017 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Napredne tehnike programiranja - Haskell</h1>
<div id="table-of-contents">
<h2>Sadr&#382;aj</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgf6ab741">1. Uvod</a>
<ul>
<li><a href="#orgc27e1af">1.1. Tipovi</a></li>
<li><a href="#org47c1a9b">1.2. Apstrakcije</a></li>
<li><a href="#orgbc31201">1.3. <i>Wholemeal</i> programiranje</a></li>
<li><a href="#org7e080d5">1.4. Elementi jezika</a>
<ul>
<li><a href="#org280aa1b">1.4.1. Dekleracije i variable</a></li>
<li><a href="#org098e4dc">1.4.2. Osnovni tipovi</a></li>
<li><a href="#org17e0c97">1.4.3. Aritmetika</a></li>
<li><a href="#orge2ecd83">1.4.4. Boolova logika</a></li>
<li><a href="#orgafda975">1.4.5. Definisanje osnovnih funkcija</a></li>
<li><a href="#orgec38321">1.4.6. Parovi</a></li>
<li><a href="#orgd361c4b">1.4.7. Funkcije više argumenata</a></li>
<li><a href="#org3d98156">1.4.8. Liste</a></li>
<li><a href="#orgcc4fa33">1.4.9. Konstrukcija listi</a></li>
<li><a href="#orgf656466">1.4.10. Funkcije nad listama</a></li>
<li><a href="#org8e5ab39">1.4.11. Kombinovanje funkcija</a></li>
<li><a href="#org9b8a07a">1.4.12. Pragme</a></li>
</ul>
</li>
<li><a href="#orga50e7af">1.5. Kompajler (GHC)</a>
<ul>
<li><a href="#org445f6e1">1.5.1. <i>Type inference</i></a></li>
<li><a href="#orgccc225d">1.5.2. Sugestije kompajlera</a></li>
</ul>
</li>
<li><a href="#org0e9fb59">1.6. GHCi</a></li>
<li><a href="#org4a4f963">1.7. IDE</a>
<ul>
<li><a href="#org380b753">1.7.1. Hoogle</a></li>
<li><a href="#org03af431">1.7.2. Stack &amp; Stackage</a></li>
</ul>
</li>
<li><a href="#org7ed3a7e">1.8. Čitanje poruka o grešci</a></li>
<li><a href="#orge411d28">1.9. Ograničenja GHC kompajlera&#xa0;&#xa0;&#xa0;<span class="tag"><span class="za_radoznale">za_radoznale</span></span></a>
<ul>
<li><a href="#org5e15c28">1.9.1. Monomorfizam restrikcija</a></li>
</ul>
</li>
<li><a href="#orga577f51">1.10. Zadaci 1</a></li>
</ul>
</li>
<li><a href="#org45c8b8c">2. Funkcije</a></li>
<li><a href="#orgb9e2c69">3. Tipovi</a>
<ul>
<li><a href="#org0a370d9">3.1. <code>nešto :: tip</code>, sve ima tip</a></li>
<li><a href="#orge83eaa3">3.2. Kinds</a></li>
</ul>
</li>
<li><a href="#orgc622c3b">4. Data deklaracije</a>
<ul>
<li><a href="#orgdec8474">4.1. Data konstruktor &amp; value konstruktor</a>
<ul>
<li><a href="#orgda61ed0">4.1.1. Records sintaksa</a></li>
</ul>
</li>
<li><a href="#orgeb75949">4.2. <code>newtype</code></a></li>
<li><a href="#org0d516c0">4.3. <code>type</code></a></li>
</ul>
</li>
<li><a href="#orga632a58">5. Haskell &#x2014; lazy by default</a>
<ul>
<li><a href="#org56f6d56">5.1. <i>Strict evaluation vs. lazy evaluation</i></a>
<ul>
<li><a href="#orgafae8d9">5.1.1. Cena <i>strict</i> izračunavanja</a></li>
<li><a href="#org0e960c9">5.1.2. Cena <i>lazy</i> izračunavanja</a></li>
</ul>
</li>
<li><a href="#orge9081f5">5.2. Haskell <i>laziness look and feel</i> vs. Java <i>Supliers</i> ("<i>type level laziness</i>")</a></li>
</ul>
</li>
<li><a href="#orgba7563a">6. Polimorfizam</a></li>
<li><a href="#orgc7eb33d">7. GADTs</a></li>
<li><a href="#orgced3976">8. Type Classes</a>
<ul>
<li><a href="#org06ee300">8.1. Automatsko instanciranje sa <code>deriving</code></a></li>
<li><a href="#org4af5ca5">8.2. <code>class</code> NIJE <code>class</code> iz Pythona i Jave</a></li>
<li><a href="#org710f5d0">8.3. <i>fundeps</i> (Functional Dependencies)</a></li>
</ul>
</li>
<li><a href="#orgc7b77f8">9. Monoidi</a></li>
<li><a href="#org5c82cdd">10. Funktori</a></li>
<li><a href="#org11bac45">11. Aplikativni funktori</a></li>
<li><a href="#org4f6c592">12. Monade</a>
<ul>
<li><a href="#orgfd5bc45">12.1. IO</a></li>
</ul>
</li>
<li><a href="#org0b34ea0">13. Profiling</a>
<ul>
<li><a href="#orgdcfa1e2">13.1. Primitivni profiling samo sa Unix <code>time</code></a></li>
<li><a href="#org447b7f4">13.2. GHC podrška za profiling</a>
<ul>
<li><a href="#orgdca3328">13.2.1. Još neke <i>RTS</i> (<i>Run Time System</i>) opcije</a></li>
<li><a href="#org6afdf56">13.2.2. Potrošnja memorije kroz vreme</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgdd5b6bd">14. Haskell Core&#xa0;&#xa0;&#xa0;<span class="tag"><span class="za_radoznale">za_radoznale</span></span></a></li>
<li><a href="#orgd0656cc">15. Literatura</a></li>
</ul>
</div>
</div>

<div class="figure">
<p><img src="images/haskell_logo.png" alt="haskell_logo.png" width="400px" />
</p>
</div>

<blockquote>
<p>
An advanced, purely functional, statically typed, lazy programming
language.
</p>
</blockquote>

<div id="outline-container-orgf6ab741" class="outline-2">
<h2 id="orgf6ab741"><span class="section-number-2">1</span> Uvod<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup></h2>
<div class="outline-text-2" id="text-1">
<p>
Haskell je čisto funkcionalan programski jezik opšte
namene. Karakteriše ga <a href="https://en.wikipedia.org/wiki/Evaluation_strategy#Non-strict_evaluation">non-strict</a> semantika i stroga statička
tipizacija. Ime je dobio po logičaru <a href="https://en.wikipedia.org/wiki/Haskell_Curry">Haskell Curry</a>-ju. Nastao je
kasnih 80-tih godina kao rezultat rada grupe akademaca u oblasti
računarskih nauka. Haskell je izgrađen oko veoma napredanog <i>type
system</i>-a koji sadrži algoritam za zaključivanje tipova (<a href="https://en.wikipedia.org/wiki/Type_inference">type
inference</a>) pa se veoma malo jezičkih konstrukcija u kodu mora
eksplicitno obeležiti tipovima.
</p>

<p>
Haskell jasno nameće način razmišljanja. Jedino kod nastao čisto
funkcionalnim načinom razmišljanja se može<sup><a id="fnr.2" class="footref" href="#fn.2">2</a></sup> zapisati u
Haskell-u.
</p>

<p>
Pošto je "funckionalan programski jezik" veoma rastegljiv pojam
odmah ovde na početku ćemo reći šta za nas znači da je Haskell
funkcionalan:
</p>

<ul class="org-ul">
<li>Funkcije su prvoklasni koncepti.</li>
<li>Značenje Haskell programa je izgrađeno na osnovu izračunavanja
izraza a ne na izvršavanju naredbi &#x2014; <i>Haskell nema naredbe</i>.</li>
</ul>

<p>
Pošto je "čisto funkcionalan programski jezik" takođe rastegljiv
pojam u poslednje vreme i to ćemo odmah na početku jasno
odrediti. Kada kažemo da je Haskell čisto funkcionalan programski
jezik to znači:
</p>

<ul class="org-ul">
<li>Nema mutiranja, nigde! Sve je imutabilno.</li>
<li>Izrazi nikada nemaju sporedne efekte (ni kod ispisivanja na
ekran<sup><a id="fnr.3" class="footref" href="#fn.3">3</a></sup>).</li>
<li>Sve funkcije za iste ulaze vraćaju iste izlaze.</li>
</ul>

<p>
Haskell je istinski lenj. Dakle, <span class="underline">nije da većina funckija vraća
lenje sekvence</span> već nešto striktnije:
</p>

<ul class="org-ul">
<li>Izrazi ( <span class="underline">svi</span>, <span class="underline">bilo koji</span> ) se ne evaluiraju dok njihov rezultat
nije potreban za neko drugo izračunavanje.</li>
<li>Omogućuje kompozicijsko programiranje (<a href="#orgbc31201">wholemeal programiranje</a>).</li>
<li>To ima svoju manu &#x2014; rezonovanje o korišćenju vremena i prostora
postaje dosta komplikovanije.</li>
</ul>

<p>
Haskell je statički tipiziran jezik &#x2014; <span class="underline">svaki</span> izraz ima svoj tip i
svi tipovi se proveravaju u vreme kompajliranja. Program koji nije
korektan sa stanovišta tipova se ne može kompajlirati a još manje
pokrenuti. Tipovi izraza <span class="underline">nisu</span> dostupni u vreme izvršavanja &#x2014;
<span class="underline">nisu</span> ni potrebni, kompajlirani kod je <span class="underline">korektan</span> i to je dokazivo
"matematikom koja stoji iza Haskell kompajlera".
</p>

<p>
U nastavku ćemo dati neke ideje koje su od najveće važnosti u
Haskell porgramiranju.
</p>
</div>

<div id="outline-container-orgc27e1af" class="outline-3">
<h3 id="orgc27e1af"><span class="section-number-3">1.1</span> Tipovi</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Haskell ima statički type sistem. Statički type sistemi propisuju
da tipovi izraza (a u procedurnim jezivima objekata, promenljivih)
moraju biti poznati u vreme kompajliranja.
</p>

<p>
Kada programer u kodu mora da anotira sve izraze to može da bude
prilično dosadna stvar. Ono što je bitno da zapamtimo je:
</p>

<blockquote>
<p>
Obavezna anotacija svih izraza u programu <span class="underline">nije</span> osobina statičkih
type sistema već pre posledica nedovoljne ekspresivnosti <span class="underline">nekih</span>
statičkih type sistema (kao što je slučaj kod Java, C, C++, C#&#x2026;).
</p>
</blockquote>

<p>
Haskell-ov type sistem nam daje sledeće stvari:
</p>

<ul class="org-ul">
<li><p>
Pomaže nam da promislimo i izrazimo svoj program
</p>

<p>
Prvi korak u pisanju Haskell programa je popišemo sve tipove koji
su potrebni. Pošto je Haskell-ov type sistem prilično ekspresivan
to nije trivijalan zadatak ali zato jeste veliki korak ka jasnom
razumevanju strukture programa.
</p></li>

<li><p>
Služi kao forma dokumentacije
</p>

<p>
Type sistem je toliko ekspresivan da čitanje tipa funkcije
najčešće već samo govori sasvim dovoljno o tome šta funkcija radi
pa tekst o tome šta funckija radi nije neophodan. Mnoge
standardne Haskell funckije nemaju dokumentaciju u vidu teksta!
</p></li>

<li><p>
Pretvara <i>run-time</i> greške u <i>compile-time</i> greške
</p>

<p>
Bolje je imati korektan program nakon kompajliranja nego
beskrajno testirati u <i>run-time</i>-u. Haskell ima maksimu &#x2014; <b>ako
se kompajlira onda je korektno</b>. Postoji mogućnost da se
"provuče" neka greška vezana za logiku programa ali se i to u
Haskell-u očekuje ređe nego u ostalim programskim jezicima.
</p></li>
</ul>
</div>
</div>

<div id="outline-container-org47c1a9b" class="outline-3">
<h3 id="org47c1a9b"><span class="section-number-3">1.2</span> Apstrakcije</h3>
<div class="outline-text-3" id="text-1-2">
<p>
"Don't Repeat Yourself" je česta mantra koja se čuje u današnjem
programiranju, u nauci se zove još i <i>Princip Apstrakcije</i>. Idaja
je da ništa ne treba pisati više puta: svaka ideja, algoritam,
parče podatka treba da se pojavi samo na jednom jedinom mestu u
kodu. Izdvajanje sličnih delova koda se naziva procesom
apstrakcije.
</p>

<p>
Haskell je vrlo dobar u apstrahovanju. Koncepti kao što su
<i>parametric polymorphism</i>, funkcije višeg reda, <i>type classes</i> i
drugi za cilj imaju da se izbore za princip apstrakcije.
</p>

<blockquote>
<p>
Da li je Vaš softver <i>DRY</i>?
</p>

<p>
Šta je Vaš izgovor?
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgbc31201" class="outline-3">
<h3 id="orgbc31201"><span class="section-number-3">1.3</span> <i>Wholemeal</i> programiranje</h3>
<div class="outline-text-3" id="text-1-3">
<p>
Citat <a href="http://www.cs.ox.ac.uk/ralf.hinze/">Ralf Hinze</a>:
</p>

<blockquote>
<p>
“Functional languages excel at wholemeal programming, a term coined
by Geraint Jones. Wholemeal programming means to think big: work
with an entire list, rather than a sequence of elements; develop a
solution space, rather than an individual solution; imagine a
graph, rather than a single path. The wholemeal approach often
offers new insights or provides new perspectives on a given
problem. It is nicely complemented by the idea of projective
programming: first solve a more general problem, then extract the
interesting bits and pieces by transforming the general program
into more specialised ones.”
</p>
</blockquote>

<p>
<i>Wholemeal</i> programiranje je dakle <a href="https://sh.wikipedia.org/wiki/Dedukcija">deduktivan</a> proces.
</p>

<p>
Pogledajmo ovo parče pseudo Java/C#/C&#x2026; koda:
</p>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #7CB8BB;">int</span> <span style="color: #DFAF8F;">acc</span> = 0;
<span style="color: #F0DFAF; font-weight: bold;">for</span> ( <span style="color: #7CB8BB;">int</span> <span style="color: #DFAF8F;">i</span> = 0; i &lt; lst.length; i++ ) {
    acc = acc + 3 * lst[i];
}
</pre>
</div>

<p>
<a href="http://www.cs.ox.ac.uk/people/richard.bird/">Richard Bird</a> kaže da ovo parče koda boluje od "indeksitisa": brine
se o iteriranju kroz niz na niskom nivou &#x2014; tako što prati
indekse. Pored toga još i meša u jedno ono što se obično smatra kao
dve operacije &#x2014; uvećavanje svakog elementa za 3 i sabiranje svih
elemenata. U Haskell-u to bismo uradili ovako:
</p>

<div class="org-src-container">
<pre class="src src-haskell">sum <span style="color: #93E0E3;">$</span> map (3<span style="color: #DFAF8F;">*</span>) lst
</pre>
</div>
</div>
</div>

<div id="outline-container-org7e080d5" class="outline-3">
<h3 id="org7e080d5"><span class="section-number-3">1.4</span> Elementi jezika</h3>
<div class="outline-text-3" id="text-1-4">
<p>
Možemo reći da se Haskell sastoji iz dva jezika: <b>jezik tipova</b> i
<b>jezik izraza</b> gde prvi nije obavezno pisati jer <i>type inference</i>
algoritam ume da zaključi informacije koje on nosi. Konstrukcija
<code>::</code> razdvaja ova dva jezika.
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">jezik</span> izraza <span style="color: #DFAF8F;">::</span> jezik tipova
</pre>
</div>

<p>
<code>::</code> se još čita i "ima tip".
</p>
</div>

<div id="outline-container-org280aa1b" class="outline-4">
<h4 id="org280aa1b"><span class="section-number-4">1.4.1</span> Dekleracije i variable</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
Deklarisanje promenljivih možemo uraditi na sledeći način:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">this is a declaration</span>
<span style="color: #93E0E3;">x</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Int</span>
<span style="color: #93E0E3;">x</span> <span style="color: #DFAF8F;">=</span> 23
<span style="color: #5F7F5F;">{- </span><span style="color: #7F9F7F;">this was declaration with some long long multi-line comment which</span>
<span style="color: #7F9F7F;"> exceeds standard line lenght in my editor</span>
<span style="color: #7F9F7F;">-}</span>
</pre>
</div>

<p>
Kod iznad deklariše variablu koja ima tip <code>Int</code> i
vrednost 3. Imajte u vidu da se ova promenljiva <b>ne može</b> više
nikada promeniti ona će do kraja sveta(dobro programa) imati
vrednost koju smo joj ovde zadali. Takođe, ako pokušamo negde
drugo ponovo da deklarišemo ovu istu variablu kompajler će
prijaviti grešku:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">x = 42</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">src/Intro.hs:10:1: error: &#8230;</span>
<span style="color: #5F7F5F;">--     </span><span style="color: #7F9F7F;">Multiple declarations of &#8216;x&#8217;</span>
<span style="color: #5F7F5F;">--     </span><span style="color: #7F9F7F;">Declared at: /home/novak/haskell/haskellNTP/showcase/src/Intro.hs:5:1</span>
<span style="color: #5F7F5F;">--                  </span><span style="color: #7F9F7F;">/home/novak/haskell/haskellNTP/showcase/src/Intro.hs:10:1</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Compilation failed.</span>
</pre>
</div>

<p>
Dakle, <i>=</i> <b>ne predstavlja</b> <i>dodelu</i> kao što je slučaj u mnogim
drugim jezicima već <i>definiciju</i> kao u matematici. Dakle <code>x = 1</code>
se <b>ne čita</b> kao "x dobija vrednost 1" ili "dodeljujem broj 4
promenljivoj x" već <b>"x je definisano kao 1"</b>. Šta radi sledeći
kod?
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">b</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Int</span>
<span style="color: #93E0E3;">b</span> <span style="color: #DFAF8F;">=</span> b <span style="color: #DFAF8F;">+</span> 1
</pre>
</div>
</div>
</div>

<div id="outline-container-org098e4dc" class="outline-4">
<h4 id="org098e4dc"><span class="section-number-4">1.4.2</span> Osnovni tipovi</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
<code>Int</code> je osnovni celobrojni tip i po standardu mora biti u stanju
da prikaže vrednosti u opsegu ne manjem od \(\pm2^{29}\). Na
standardnim 64-bitnim mašinama je \(\pm2^{63}\). Maksimalna i
minimalna vrednost <code>Int</code> tipa su date sa <code>biggestInt</code> i
<code>smallestInt</code>:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">biggestInt, smallestInt</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Int</span>
<span style="color: #93E0E3;">biggestInt</span> <span style="color: #DFAF8F;">=</span> maxBound
<span style="color: #93E0E3;">smallestInt</span> <span style="color: #DFAF8F;">=</span> minBound
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; biggestInt</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">9223372036854775807</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; smallestInt</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">-9223372036854775808</span>
</pre>
</div>

<p>
<code>Integer</code> tip je proizvoljne preciznosti i ograničen je samo
memorijom računara:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">bigInteger</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Integer</span>
<span style="color: #93E0E3;">bigInteger</span> <span style="color: #DFAF8F;">=</span> 1234567890987654321987340982334987349872349874534
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; bigInteger</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">1234567890987654321987340982334987349872349874534</span>

<span style="color: #93E0E3;">reallyBig</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Integer</span>
<span style="color: #93E0E3;">reallyBig</span> <span style="color: #DFAF8F;">=</span> 2<span style="color: #DFAF8F;">^</span>(2<span style="color: #DFAF8F;">^</span>(2<span style="color: #DFAF8F;">^</span>(2<span style="color: #DFAF8F;">^</span>2)))

<span style="color: #93E0E3;">digitsNumOfReallyBig</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Int</span>
<span style="color: #93E0E3;">digitsNumOfReallyBig</span> <span style="color: #DFAF8F;">=</span> length (show reallyBig)
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; digitsNumOfReallyBig</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">19729</span>
</pre>
</div>

<p>
<code>Float</code> je standardan tip za predstavu razlomljenih brojeva u
<i>single-precision</i>, <code>Double</code> je <i>double-precision</i>:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">d1, d2</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Double</span>
<span style="color: #93E0E3;">d1</span> <span style="color: #DFAF8F;">=</span> 4.5387
<span style="color: #93E0E3;">d2</span> <span style="color: #DFAF8F;">=</span> 6.2831e-4
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; d1</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">4.5387</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; d2</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">6.2831e-4</span>
</pre>
</div>

<p>
Tu su i <code>Bool</code>, <code>Char</code> i <code>String</code>:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">b1, b2</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Bool</span>
<span style="color: #93E0E3;">b1</span> <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">True</span>
<span style="color: #93E0E3;">b2</span> <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">False</span>

<span style="color: #93E0E3;">c1, c2, c3</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Char</span>
<span style="color: #93E0E3;">c1</span> <span style="color: #DFAF8F;">=</span> <span style="color: #CC9393;">'x'</span>
<span style="color: #93E0E3;">c2</span> <span style="color: #DFAF8F;">=</span> <span style="color: #CC9393;">'&#216;'</span>
<span style="color: #93E0E3;">c3</span> <span style="color: #DFAF8F;">=</span> <span style="color: #CC9393;">'&#12480;'</span>

<span style="color: #93E0E3;">s</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">String</span>
<span style="color: #93E0E3;">s</span> <span style="color: #DFAF8F;">=</span> <span style="color: #CC9393;">"Hello, Haskell!"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org17e0c97" class="outline-4">
<h4 id="org17e0c97"><span class="section-number-4">1.4.3</span> Aritmetika</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
Probajmo sledeće izraze:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">ex01</span> <span style="color: #DFAF8F;">=</span> 3 <span style="color: #DFAF8F;">+</span> 2
<span style="color: #93E0E3;">ex02</span> <span style="color: #DFAF8F;">=</span> 19 <span style="color: #DFAF8F;">-</span> 27
<span style="color: #93E0E3;">ex03</span> <span style="color: #DFAF8F;">=</span> 2.35 <span style="color: #DFAF8F;">*</span> 8.6
<span style="color: #93E0E3;">ex04</span> <span style="color: #DFAF8F;">=</span> 8.7 <span style="color: #DFAF8F;">/</span> 3.1
<span style="color: #93E0E3;">ex05</span> <span style="color: #DFAF8F;">=</span> mod 19 3
<span style="color: #93E0E3;">ex06</span> <span style="color: #DFAF8F;">=</span> 19 <span style="color: #DFAF8F;">`mod`</span> 3
<span style="color: #93E0E3;">ex07</span> <span style="color: #DFAF8F;">=</span> 7 <span style="color: #DFAF8F;">^</span> 222
<span style="color: #93E0E3;">ex08</span> <span style="color: #DFAF8F;">=</span> (<span style="color: #DFAF8F;">-</span>3) <span style="color: #DFAF8F;">*</span> (<span style="color: #DFAF8F;">-</span>7)
</pre>
</div>

<ul class="org-ul">
<li><i>backticks</i> prefiksnu funkciju pretvaraju u infiksnu</li>
<li>minusi kao znakovi moraju biti u zagradama kako ne bi bili
parsirani kao oduzimanje</li>
</ul>

<p>
Sledeći izraz ne prolazi kompajler:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">badArith = x + bigInteger</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&lt;interactive&gt;:73:5-14: error:</span>
<span style="color: #5F7F5F;">--     </span><span style="color: #7F9F7F;">&#8226; Couldn't match expected type &#8216;Int&#8217; with actual type &#8216;Integer&#8217;</span>
<span style="color: #5F7F5F;">--     </span><span style="color: #7F9F7F;">&#8226; In the second argument of &#8216;(+)&#8217;, namely &#8216;bigInteger&#8217;</span>
<span style="color: #5F7F5F;">--       </span><span style="color: #7F9F7F;">In the expression: x + bigInteger</span>
<span style="color: #5F7F5F;">--       </span><span style="color: #7F9F7F;">In an equation for &#8216;it&#8217;: it = x + bigInteger</span>
</pre>
</div>

<p>
Haskell neće raditi implicitnu konverziju između ova dva tipa,
morate Vi eksplicitno:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">goodArith</span> <span style="color: #DFAF8F;">=</span> x <span style="color: #DFAF8F;">+</span> fromInteger(bigInteger)
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; goodArith</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">7636536262163761533</span>
</pre>
</div>

<p>
Ovo takođe ne prolazi kompajler:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">one = x / x</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&lt;interactive&gt;:80:1-5: error:</span>
<span style="color: #5F7F5F;">--     </span><span style="color: #7F9F7F;">&#8226; No instance for (Fractional Int) arising from a use of &#8216;/&#8217;</span>
<span style="color: #5F7F5F;">--     </span><span style="color: #7F9F7F;">&#8226; In the expression: x / x</span>
<span style="color: #5F7F5F;">--       </span><span style="color: #7F9F7F;">In an equation for &#8216;it&#8217;: it = x / x</span>
</pre>
</div>

<p>
Za deljenje celobrojnih vrednosti moramo da koristimo <code>div</code>:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">one</span> <span style="color: #DFAF8F;">=</span> x <span style="color: #DFAF8F;">`div`</span> x
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; one</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">1</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge2ecd83" class="outline-4">
<h4 id="orge2ecd83"><span class="section-number-4">1.4.4</span> Boolova logika</h4>
<div class="outline-text-4" id="text-1-4-4">
<p>
Ovo radi kako ste i navikli:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">ex11</span> <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">True</span> <span style="color: #DFAF8F;">&amp;&amp;</span> <span style="color: #7CB8BB;">False</span>
<span style="color: #93E0E3;">ex12</span> <span style="color: #DFAF8F;">=</span> not (<span style="color: #7CB8BB;">False</span> <span style="color: #DFAF8F;">||</span> <span style="color: #7CB8BB;">True</span>)

<span style="color: #93E0E3;">ex13</span> <span style="color: #DFAF8F;">=</span> (<span style="color: #CC9393;">'a'</span> <span style="color: #DFAF8F;">==</span> <span style="color: #CC9393;">'a'</span>)
<span style="color: #93E0E3;">ex14</span> <span style="color: #DFAF8F;">=</span> (16 <span style="color: #DFAF8F;">/=</span> 3)
<span style="color: #93E0E3;">ex15</span> <span style="color: #DFAF8F;">=</span> (5 <span style="color: #DFAF8F;">&gt;</span> 3) <span style="color: #DFAF8F;">&amp;&amp;</span> (<span style="color: #CC9393;">'p'</span> <span style="color: #DFAF8F;">&lt;=</span> <span style="color: #CC9393;">'q'</span>)
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">What is this?</span>
<span style="color: #93E0E3;">ex16</span> <span style="color: #DFAF8F;">=</span> <span style="color: #CC9393;">"Haskell"</span> <span style="color: #DFAF8F;">&gt;</span> <span style="color: #CC9393;">"C++"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgafda975" class="outline-4">
<h4 id="orgafda975"><span class="section-number-4">1.4.5</span> Definisanje osnovnih funkcija</h4>
<div class="outline-text-4" id="text-1-4-5">
<p>
Funkcije se definišu na sledeći način:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Compute the sum of the integers from 1 to n.</span>
<span style="color: #93E0E3;">sumtorial</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Integer</span> <span style="color: #DFAF8F;">-&gt;</span> <span style="color: #7CB8BB;">Integer</span>
<span style="color: #93E0E3;">sumtorial</span> 0 <span style="color: #DFAF8F;">=</span> 0
<span style="color: #93E0E3;">sumtorial</span> n <span style="color: #DFAF8F;">=</span> n <span style="color: #DFAF8F;">+</span> sumtorial (n<span style="color: #DFAF8F;">-</span>1)
</pre>
</div>

<p>
<code>Integer -&gt; Integer</code> znači da funkcija prima <code>Integer</code> i vraća
<code>Integer</code>.
</p>

<p>
U definiciji funkcije prvi izraz koji odgovara pozivu se
izvršava. Objasnite izvršavanje funkcije <code>sumtorial</code>?
</p>

<p>
Izbor poziva takođe može biti izražen i korišćenjem mehanizma koji
se zove <i>guards</i>:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">hailstone</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Integer</span> <span style="color: #DFAF8F;">-&gt;</span> <span style="color: #7CB8BB;">Integer</span>
<span style="color: #93E0E3;">hailstone</span> n
  <span style="color: #DFAF8F;">|</span> n <span style="color: #DFAF8F;">`mod`</span> 2 <span style="color: #DFAF8F;">==</span> 0 <span style="color: #DFAF8F;">=</span> n <span style="color: #DFAF8F;">`div`</span> 2
  <span style="color: #DFAF8F;">|</span> otherwise      <span style="color: #DFAF8F;">=</span> 3<span style="color: #DFAF8F;">*</span>n <span style="color: #DFAF8F;">+</span> 1
</pre>
</div>

<p>
<i>Guards</i> se izvršavaju redom &#x2014; od gore ka dole i prvi izraz koji
se evaluira u <code>True</code> će izazvati da se izvrši njegova grana
funkcije.
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">foo</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Integer</span> <span style="color: #DFAF8F;">-&gt;</span> <span style="color: #7CB8BB;">Integer</span>
<span style="color: #93E0E3;">foo</span> 0 <span style="color: #DFAF8F;">=</span> 16
<span style="color: #93E0E3;">foo</span> 1
  <span style="color: #DFAF8F;">|</span> <span style="color: #CC9393;">"Haskell"</span> <span style="color: #DFAF8F;">&gt;</span> <span style="color: #CC9393;">"C++"</span> <span style="color: #DFAF8F;">=</span> 3
  <span style="color: #DFAF8F;">|</span> otherwise         <span style="color: #DFAF8F;">=</span> 4
<span style="color: #93E0E3;">foo</span> n
  <span style="color: #DFAF8F;">|</span> n <span style="color: #DFAF8F;">&lt;</span> 0            <span style="color: #DFAF8F;">=</span> 0
  <span style="color: #DFAF8F;">|</span> n <span style="color: #DFAF8F;">`mod`</span> 17 <span style="color: #DFAF8F;">==</span> 2  <span style="color: #DFAF8F;">=</span> <span style="color: #DFAF8F;">-</span>43
  <span style="color: #DFAF8F;">|</span> otherwise        <span style="color: #DFAF8F;">=</span> n <span style="color: #DFAF8F;">+</span> 3
</pre>
</div>

<p>
Šta će biti <code>foo(-3)</code>, <code>foo(0)</code>, <code>foo(1)</code>, <code>foo(36)</code>, <code>foo(38)</code>?
</p>
</div>
</div>

<div id="outline-container-orgec38321" class="outline-4">
<h4 id="orgec38321"><span class="section-number-4">1.4.6</span> Parovi</h4>
<div class="outline-text-4" id="text-1-4-6">
<p>
Parovi služe da uparimo neke dve informacije. Postoje i ostale
n-torke ali se u praksi uglavnom koriste parovi jer za ostalo
posotje bolji načini predstavljanja.
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">p</span> <span style="color: #DFAF8F;">::</span> (<span style="color: #7CB8BB;">Int</span>, [<span style="color: #7CB8BB;">Char</span>])
<span style="color: #93E0E3;">p</span> <span style="color: #DFAF8F;">=</span> (43, <span style="color: #CC9393;">"&#269;estrestridvajestri"</span>)
</pre>
</div>

<p>
Obratiti pažnju da su n-torke različitihj tipova:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">p1</span> <span style="color: #DFAF8F;">::</span> (<span style="color: #7CB8BB;">Int</span>, [<span style="color: #7CB8BB;">Char</span>])
<span style="color: #93E0E3;">p1</span> <span style="color: #DFAF8F;">=</span> (1, <span style="color: #CC9393;">"two"</span>)

<span style="color: #93E0E3;">p2</span> <span style="color: #DFAF8F;">::</span> (<span style="color: #7CB8BB;">Integer</span>, [<span style="color: #7CB8BB;">Char</span>])
<span style="color: #93E0E3;">p2</span> <span style="color: #DFAF8F;">=</span> (1, <span style="color: #CC9393;">"two"</span>)

<span style="color: #93E0E3;">p3</span> <span style="color: #DFAF8F;">::</span> (<span style="color: #7CB8BB;">Double</span>, <span style="color: #7CB8BB;">Double</span>)
<span style="color: #93E0E3;">p3</span> <span style="color: #DFAF8F;">=</span> (2.2, 2.2)
</pre>
</div>

<p>
N-torkama se u praksi najčešće pristupa <a href="https://en.wikipedia.org/wiki/Pattern_matching">pattern matching</a>-om:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">mulPair</span> <span style="color: #DFAF8F;">::</span> (<span style="color: #7CB8BB;">Int</span>, <span style="color: #7CB8BB;">Int</span>) <span style="color: #DFAF8F;">-&gt;</span> <span style="color: #7CB8BB;">Int</span>
<span style="color: #93E0E3;">mulPair</span> (x, y) <span style="color: #DFAF8F;">=</span> x <span style="color: #DFAF8F;">*</span> y
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; mulPair (2, 3)</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">6</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd361c4b" class="outline-4">
<h4 id="orgd361c4b"><span class="section-number-4">1.4.7</span> Funkcije više argumenata</h4>
<div class="outline-text-4" id="text-1-4-7">
<p>
Funkcija sa više argumenata se definiše na sledeći način:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">multiArgFoo</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Int</span> <span style="color: #DFAF8F;">-&gt;</span> <span style="color: #7CB8BB;">Int</span> <span style="color: #DFAF8F;">-&gt;</span> <span style="color: #7CB8BB;">Int</span> <span style="color: #DFAF8F;">-&gt;</span> <span style="color: #7CB8BB;">Int</span>
<span style="color: #93E0E3;">multiArgFoo</span> x y z <span style="color: #DFAF8F;">=</span> x <span style="color: #DFAF8F;">*</span> y <span style="color: #DFAF8F;">*</span> z
<span style="color: #93E0E3;">sv</span> <span style="color: #DFAF8F;">=</span> multiArgFoo 1 2 3
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; sv</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">6</span>
</pre>
</div>

<p>
Ako Vam tip funkcije <code>multiArgFoo :: Int -&gt; Int -&gt; Int -&gt; Int</code>
deluje čudno i pitate se:
</p>

<blockquote>
<p>
Zašto ovoliko strelica, funkcija prima 3 parametra i vraća jededan
zar ne bi više imalo smisla da bude nešto kao <code>Int Int Int -&gt; Int</code>?
</p>
</blockquote>

<p>
onda ste na dobrom tragu. Razlog za ovo je dosta dublji od same
sintakse i ima valjan razlog u matematici. Razlog za ovakvu
notaciju je <a href="https://wiki.haskell.org/Currying">Currying</a>.
</p>

<blockquote>
<p>
<i>Currying</i> je proces transformacije funckije koja prima više
argumenata u funckiju koja prima samo jedan argument i vraća drugu
funkciju ako su još neki parametri potrebni.
</p>
</blockquote>

<p>
Pa tako:
</p>

<div class="org-src-container">
<pre class="src src-haskell">&#955;<span style="color: #93E0E3;">&gt;</span> foo <span style="color: #DFAF8F;">=</span> multiArgFoo 1
&#955;<span style="color: #93E0E3;">&gt;</span> <span style="color: #7CB8BB;">:</span>t foo
<span style="color: #93E0E3;">foo</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Int</span> <span style="color: #DFAF8F;">-&gt;</span> <span style="color: #7CB8BB;">Int</span> <span style="color: #DFAF8F;">-&gt;</span> <span style="color: #7CB8BB;">Int</span>
&#955;<span style="color: #93E0E3;">&gt;</span> foo1 <span style="color: #DFAF8F;">=</span> foo 2
&#955;<span style="color: #93E0E3;">&gt;</span> <span style="color: #7CB8BB;">:</span>t foo1
<span style="color: #93E0E3;">foo1</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Int</span> <span style="color: #DFAF8F;">-&gt;</span> <span style="color: #7CB8BB;">Int</span>
&#955;<span style="color: #93E0E3;">&gt;</span> res <span style="color: #DFAF8F;">=</span> foo1 3
&#955;<span style="color: #93E0E3;">&gt;</span> <span style="color: #7CB8BB;">:</span>t res
<span style="color: #93E0E3;">res</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Int</span>
&#955;<span style="color: #93E0E3;">&gt;</span> res
6
</pre>
</div>

<p>
Ovo podseća na parcijalnu primenu funkcije ali <span class="underline">to nije baš
to</span>. Pogledajte ovu diskusiju na <a href="https://stackoverflow.com/questions/218025/what-is-the-difference-between-currying-and-partial-application">StackOverflow</a> (barem prva dva
odgovora).
</p>
</div>
</div>

<div id="outline-container-org3d98156" class="outline-4">
<h4 id="org3d98156"><span class="section-number-4">1.4.8</span> Liste</h4>
<div class="outline-text-4" id="text-1-4-8">
<p>
Liste su jedne od najosnovnih struktura podataka Haskell-a.
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">nums, range, range2</span> <span style="color: #DFAF8F;">::</span> [<span style="color: #7CB8BB;">Integer</span>]
<span style="color: #93E0E3;">nums</span>   <span style="color: #DFAF8F;">=</span> [1,2,3,19]
<span style="color: #93E0E3;">range</span>  <span style="color: #DFAF8F;">=</span> [1<span style="color: #DFAF8F;">..</span>100]
<span style="color: #93E0E3;">range2</span> <span style="color: #DFAF8F;">=</span> [2,4<span style="color: #DFAF8F;">..</span>100]
<span style="color: #93E0E3;">unlimited</span> <span style="color: #DFAF8F;">=</span> [1<span style="color: #DFAF8F;">..</span>]

<span style="color: #93E0E3;">hello1</span> <span style="color: #DFAF8F;">::</span> [<span style="color: #7CB8BB;">Char</span>]
<span style="color: #93E0E3;">hello1</span> <span style="color: #DFAF8F;">=</span> [<span style="color: #CC9393;">'h'</span>, <span style="color: #CC9393;">'e'</span>, <span style="color: #CC9393;">'l'</span>, <span style="color: #CC9393;">'l'</span>, <span style="color: #CC9393;">'o'</span>]

<span style="color: #93E0E3;">hello2</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">String</span>
<span style="color: #93E0E3;">hello2</span> <span style="color: #DFAF8F;">=</span> <span style="color: #CC9393;">"hello"</span>

<span style="color: #93E0E3;">helloSame</span> <span style="color: #DFAF8F;">=</span> hello1 <span style="color: #DFAF8F;">==</span> hello2
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; helloSame</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">True</span>
</pre>
</div>

<p>
Postoji i <i>list comprehension</i>:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">l</span> <span style="color: #DFAF8F;">=</span>
  [ (x <span style="color: #DFAF8F;">`mod`</span> 3) <span style="color: #DFAF8F;">*</span> y
  <span style="color: #DFAF8F;">|</span> x <span style="color: #DFAF8F;">&lt;-</span> [1 <span style="color: #DFAF8F;">..</span> 10]
  , y <span style="color: #DFAF8F;">&lt;-</span> [2, 4, 40]
  , (x <span style="color: #DFAF8F;">*</span> y) <span style="color: #DFAF8F;">`mod`</span> 2 <span style="color: #DFAF8F;">==</span> 0 ]
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; l</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">[2,4,40,4,8,80,0,0,0,2,4,40,4,8,80,0,0,0,2,4,40,4,8,80,0,0,0,2,4,40]</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcc4fa33" class="outline-4">
<h4 id="orgcc4fa33"><span class="section-number-4">1.4.9</span> Konstrukcija listi</h4>
<div class="outline-text-4" id="text-1-4-9">
<p>
Sve liste se grade od prazne liste korišćenjem <code>cons</code> operatora
(<code>:</code>). Ovo Vam je možda poznato iz Lispa?
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">ex18</span> <span style="color: #DFAF8F;">=</span> 1 <span style="color: #7CB8BB;">:</span> <span style="color: #7CB8BB;">[]</span>
<span style="color: #93E0E3;">ex19</span> <span style="color: #DFAF8F;">=</span> 3 <span style="color: #7CB8BB;">:</span> (1 <span style="color: #7CB8BB;">:</span> <span style="color: #7CB8BB;">[]</span>)
<span style="color: #93E0E3;">ex20</span> <span style="color: #DFAF8F;">=</span> 2 <span style="color: #7CB8BB;">:</span> 3 <span style="color: #7CB8BB;">:</span> 4 <span style="color: #7CB8BB;">:</span> <span style="color: #7CB8BB;">[]</span>
<span style="color: #93E0E3;">ex21</span> <span style="color: #DFAF8F;">=</span> [2,3,4] <span style="color: #DFAF8F;">==</span> 2 <span style="color: #7CB8BB;">:</span> 3 <span style="color: #7CB8BB;">:</span> 4 <span style="color: #7CB8BB;">:</span> <span style="color: #7CB8BB;">[]</span>
</pre>
</div>

<p>
Obratite pažnju da su ovo prave jednostruko spregnute liste a ne
nizovi. Uzgred, šta je razlika između niza i jednostruko spregnute
liste?
</p>
</div>
</div>

<div id="outline-container-orgf656466" class="outline-4">
<h4 id="orgf656466"><span class="section-number-4">1.4.10</span> Funkcije nad listama</h4>
<div class="outline-text-4" id="text-1-4-10">
<p>
Funkcije koje rade sa listama takođe koriste <i>pattern matching</i>:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Compute the length of a list of Integers.</span>
<span style="color: #93E0E3;">intListLength</span> <span style="color: #DFAF8F;">::</span> [<span style="color: #7CB8BB;">Integer</span>] <span style="color: #DFAF8F;">-&gt;</span> <span style="color: #7CB8BB;">Integer</span>
<span style="color: #93E0E3;">intListLength</span> <span style="color: #7CB8BB;">[]</span>     <span style="color: #DFAF8F;">=</span> 0
<span style="color: #93E0E3;">intListLength</span> (<span style="color: #F0DFAF; font-weight: bold;">_</span><span style="color: #7CB8BB;">:</span>xs) <span style="color: #DFAF8F;">=</span> 1 <span style="color: #DFAF8F;">+</span> intListLength xs
</pre>
</div>

<p>
Pošto prvi element liste ne koristimo ne moramo ni da koirstimo
ime za njega i zato imamo <code>intListLength (_:xs)</code>. Ovo je
rekurzija, uslov završetka je dat elegantno zar ne?
</p>

<p>
Paterni mogu da se ugnježdavaju:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #93E0E3;">sumEveryTwo</span> <span style="color: #DFAF8F;">::</span> [<span style="color: #7CB8BB;">Integer</span>] <span style="color: #DFAF8F;">-&gt;</span> [<span style="color: #7CB8BB;">Integer</span>]
<span style="color: #93E0E3;">sumEveryTwo</span> <span style="color: #7CB8BB;">[]</span>         <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">[]</span>     <span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Do nothing to the empty list</span>
<span style="color: #93E0E3;">sumEveryTwo</span> (x<span style="color: #7CB8BB;">:[]</span>)     <span style="color: #DFAF8F;">=</span> [x]    <span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Do nothing to lists with a single element</span>
<span style="color: #93E0E3;">sumEveryTwo</span> (x<span style="color: #7CB8BB;">:</span>(y<span style="color: #7CB8BB;">:</span>zs)) <span style="color: #DFAF8F;">=</span> (x <span style="color: #DFAF8F;">+</span> y) <span style="color: #7CB8BB;">:</span> sumEveryTwo zs
</pre>
</div>
</div>
</div>

<div id="outline-container-org8e5ab39" class="outline-4">
<h4 id="org8e5ab39"><span class="section-number-4">1.4.11</span> Kombinovanje funkcija</h4>
<div class="outline-text-4" id="text-1-4-11">
<p>
Haskell kao funckionalan jezik inspiriše da rešenja većih problema
gradimo kroz rešavanje manjih porcija problema. Pa tako kopleksne
funkcije gradimo kombinovanjem jednostavnijijh.
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Generate the sequence of hailstone iterations from a starting number.</span>
<span style="color: #93E0E3;">hailstoneSeq</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Integer</span> <span style="color: #DFAF8F;">-&gt;</span> [<span style="color: #7CB8BB;">Integer</span>]
<span style="color: #93E0E3;">hailstoneSeq</span> 1 <span style="color: #DFAF8F;">=</span> [1]
<span style="color: #93E0E3;">hailstoneSeq</span> n <span style="color: #DFAF8F;">=</span> n <span style="color: #7CB8BB;">:</span> hailstoneSeq (hailstone n)

<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">The number of hailstone steps needed to reach 1 from a starting</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">number.</span>
<span style="color: #93E0E3;">hailstoneLen</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Integer</span> <span style="color: #DFAF8F;">-&gt;</span> <span style="color: #7CB8BB;">Integer</span>
<span style="color: #93E0E3;">hailstoneLen</span> n <span style="color: #DFAF8F;">=</span> intListLength (hailstoneSeq n) <span style="color: #DFAF8F;">-</span> 1
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; hailstoneSeq 100</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">[100,50,25,76,38,19,58,29,88,44,22,11,34,17,52,26,13,40,20,10,5,16,8,4,2,1]</span>
</pre>
</div>

<p>
Kako vam ovo deluje?
</p>

<p>
Možda mislite: ovo nije memorijski efikasno, treba da potroši
vreme i memoriju da napravi celu <a href="https://en.wikipedia.org/wiki/3x_%2B_1_problem">hailstone</a> sekvencu od <code>n</code> pa onda
da računa njenu dužinu.
</p>

<p>
Zapravo, zahvaljujući lenjoj eveluaciji čitavo računanje koristi
<code>O(1)</code> momoriju bez obzira na dužinu sekvence. Zapravo <span class="underline">skoro</span>
O(n) ali o tome će biti reči kasnije. Sada možete da probate to u
praksi, probajte:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; hailstoneLen 9</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">19</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; hailstoneLen 9999999999999999999999999999999999999999999999999999999999999</span><span style="color: #DC8CC3; background-color: #3F3F3F;">99999999</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">2026</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9b8a07a" class="outline-4">
<h4 id="org9b8a07a"><span class="section-number-4">1.4.12</span> Pragme</h4>
<div class="outline-text-4" id="text-1-4-12">
<p>
<code>{-# LANGUAGE #-}</code> <code>{-# OPTIONS_GHC #-}</code> <code>{-# INCLUDE #-}</code> <code>{-# INFIX #-}</code>
<code>{-# DEPRECATED #-}</code> <code>{-# WARNING #-}</code> <code>{-# RULES #-}</code>
</p>
</div>
</div>
</div>
<div id="outline-container-orga50e7af" class="outline-3">
<h3 id="orga50e7af"><span class="section-number-3">1.5</span> Kompajler (GHC)</h3>
<div class="outline-text-3" id="text-1-5">
</div><div id="outline-container-org445f6e1" class="outline-4">
<h4 id="org445f6e1"><span class="section-number-4">1.5.1</span> <i>Type inference</i></h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
Haskell je implicitno tipiziran jezik (<i>implicitly-typed</i>) za
razliku od C/C++, Java, C#, Go i dr. koji su eksplicitno
tipizirani (explicitly-typed).
</p>
</div>
</div>
<div id="outline-container-orgccc225d" class="outline-4">
<h4 id="orgccc225d"><span class="section-number-4">1.5.2</span> Sugestije kompajlera</h4>
</div>
</div>
<div id="outline-container-org0e9fb59" class="outline-3">
<h3 id="org0e9fb59"><span class="section-number-3">1.6</span> GHCi</h3>
<div class="outline-text-3" id="text-1-6">
<p>
GHCi je Haskell REPL. Listu opcija koju pruža možete naći sa <code>:?</code>:
</p>

<div class="org-src-container">
<pre class="src src-haskell">&#955;<span style="color: #93E0E3;">&gt;</span> <span style="color: #7CB8BB;">:?</span>
 <span style="color: #7CB8BB;">Commands</span> available from the prompt<span style="color: #7CB8BB;">:</span>

   <span style="color: #DFAF8F;">&lt;</span>statement<span style="color: #DFAF8F;">&gt;</span>                 evaluate<span style="color: #DFAF8F;">/</span>run <span style="color: #DFAF8F;">&lt;</span>statement<span style="color: #DFAF8F;">&gt;</span>
   <span style="color: #7CB8BB;">:</span>                           repeat last command
   <span style="color: #7CB8BB;">:</span>{<span style="color: #DFAF8F;">\</span>n <span style="color: #DFAF8F;">..</span>lines<span style="color: #DFAF8F;">..</span> <span style="color: #DFAF8F;">\</span>n<span style="color: #7CB8BB;">:</span>}<span style="color: #DFAF8F;">\</span>n       multiline command
   <span style="color: #7CB8BB;">:</span>add [<span style="color: #DFAF8F;">*</span>]<span style="color: #DFAF8F;">&lt;</span><span style="color: #F0DFAF; font-weight: bold;">module</span><span style="color: #DFAF8F;">&gt;</span> <span style="color: #DFAF8F;">...</span>        add <span style="color: #F0DFAF; font-weight: bold;">module</span>(s) to the current target set
   <span style="color: #7CB8BB;">:</span>browse[<span style="color: #DFAF8F;">!</span>] [[<span style="color: #DFAF8F;">*</span>]<span style="color: #DFAF8F;">&lt;</span>mod<span style="color: #DFAF8F;">&gt;</span>]       display the names defined by <span style="color: #F0DFAF; font-weight: bold;">module</span> <span style="color: #DFAF8F;">&lt;</span>mod<span style="color: #DFAF8F;">&gt;</span>
                               (<span style="color: #DFAF8F;">!:</span> more details; <span style="color: #DFAF8F;">*:</span> all top<span style="color: #DFAF8F;">-</span>level names)
   <span style="color: #7CB8BB;">:</span>cd <span style="color: #DFAF8F;">&lt;</span>dir<span style="color: #DFAF8F;">&gt;</span>                   change directory to <span style="color: #DFAF8F;">&lt;</span>dir<span style="color: #DFAF8F;">&gt;</span>
   <span style="color: #7CB8BB;">:</span>cmd <span style="color: #DFAF8F;">&lt;</span>expr<span style="color: #DFAF8F;">&gt;</span>                 run the commands returned by <span style="color: #DFAF8F;">&lt;</span>expr<span style="color: #DFAF8F;">&gt;::</span><span style="color: #7CB8BB;">IO</span> <span style="color: #7CB8BB;">String</span>
   <span style="color: #7CB8BB;">:</span>complete <span style="color: #DFAF8F;">&lt;</span>dom<span style="color: #DFAF8F;">&gt;</span> [<span style="color: #DFAF8F;">&lt;</span>rng<span style="color: #DFAF8F;">&gt;</span>] <span style="color: #DFAF8F;">&lt;</span>s<span style="color: #DFAF8F;">&gt;</span> list completions for partial input string
   <span style="color: #7CB8BB;">:</span>ctags[<span style="color: #DFAF8F;">!</span>] [<span style="color: #DFAF8F;">&lt;</span>file<span style="color: #DFAF8F;">&gt;</span>]          create tags file <span style="color: #DFAF8F;">&lt;</span>file<span style="color: #DFAF8F;">&gt;</span> for <span style="color: #7CB8BB;">Vi</span> (<span style="color: #F0DFAF; font-weight: bold;">default</span><span style="color: #7CB8BB;">:</span> <span style="color: #CC9393;">"tags"</span>)
                               (<span style="color: #DFAF8F;">!:</span> use regex instead <span style="color: #F0DFAF; font-weight: bold;">of</span> line number)
   <span style="color: #7CB8BB;">:</span>def <span style="color: #DFAF8F;">&lt;</span>cmd<span style="color: #DFAF8F;">&gt;</span> <span style="color: #DFAF8F;">&lt;</span>expr<span style="color: #DFAF8F;">&gt;</span>           define command <span style="color: #7CB8BB;">:&lt;</span>cmd<span style="color: #DFAF8F;">&gt;</span> (later defined command has
                               precedence, <span style="color: #7CB8BB;">::&lt;</span>cmd<span style="color: #DFAF8F;">&gt;</span> is always a builtin command)
   <span style="color: #7CB8BB;">:</span>edit <span style="color: #DFAF8F;">&lt;</span>file<span style="color: #DFAF8F;">&gt;</span>                edit file
   <span style="color: #7CB8BB;">:</span>edit                       edit last <span style="color: #F0DFAF; font-weight: bold;">module</span>
   <span style="color: #7CB8BB;">:</span>etags [<span style="color: #DFAF8F;">&lt;</span>file<span style="color: #DFAF8F;">&gt;</span>]             create tags file <span style="color: #DFAF8F;">&lt;</span>file<span style="color: #DFAF8F;">&gt;</span> for <span style="color: #7CB8BB;">Emacs</span> (<span style="color: #F0DFAF; font-weight: bold;">default</span><span style="color: #7CB8BB;">:</span> <span style="color: #CC9393;">"TAGS</span><span style="color: #DC8CC3; background-color: #3F3F3F;">"</span><span style="color: #DC8CC3; background-color: #3F3F3F;">)</span>
   <span style="color: #7CB8BB;">:</span>help, <span style="color: #7CB8BB;">:?</span>                   display this list <span style="color: #F0DFAF; font-weight: bold;">of</span> commands
   <span style="color: #7CB8BB;">:</span>info[<span style="color: #DFAF8F;">!</span>] [<span style="color: #DFAF8F;">&lt;</span>name<span style="color: #DFAF8F;">&gt;</span> <span style="color: #DFAF8F;">...</span>]       display information about the given names
                               (<span style="color: #DFAF8F;">!:</span> <span style="color: #F0DFAF; font-weight: bold;">do</span> not filter instances)
   <span style="color: #7CB8BB;">:</span>issafe [<span style="color: #DFAF8F;">&lt;</span>mod<span style="color: #DFAF8F;">&gt;</span>]             display safe haskell information <span style="color: #F0DFAF; font-weight: bold;">of</span> <span style="color: #F0DFAF; font-weight: bold;">module</span> <span style="color: #DFAF8F;">&lt;</span>mod<span style="color: #DFAF8F;">&gt;</span>
   <span style="color: #7CB8BB;">:</span>kind[<span style="color: #DFAF8F;">!</span>] <span style="color: #DFAF8F;">&lt;</span><span style="color: #F0DFAF; font-weight: bold;">type</span><span style="color: #DFAF8F;">&gt;</span>             show the kind <span style="color: #F0DFAF; font-weight: bold;">of</span> <span style="color: #DFAF8F;">&lt;</span><span style="color: #F0DFAF; font-weight: bold;">type</span><span style="color: #DFAF8F;">&gt;</span>
                               (<span style="color: #DFAF8F;">!:</span> also print the normalised <span style="color: #F0DFAF; font-weight: bold;">type</span>)
   <span style="color: #7CB8BB;">:</span>load[<span style="color: #DFAF8F;">!</span>] [<span style="color: #DFAF8F;">*</span>]<span style="color: #DFAF8F;">&lt;</span><span style="color: #F0DFAF; font-weight: bold;">module</span><span style="color: #DFAF8F;">&gt;</span> <span style="color: #DFAF8F;">...</span>    load <span style="color: #F0DFAF; font-weight: bold;">module</span>(s) and their dependents
                               (<span style="color: #DFAF8F;">!:</span> defer <span style="color: #F0DFAF; font-weight: bold;">type</span> errors)
   <span style="color: #7CB8BB;">:</span>main [<span style="color: #DFAF8F;">&lt;</span>arguments<span style="color: #DFAF8F;">&gt;</span> <span style="color: #DFAF8F;">...</span>]     run the main function with the given arguments
   <span style="color: #7CB8BB;">:</span><span style="color: #F0DFAF; font-weight: bold;">module</span> [<span style="color: #DFAF8F;">+/-</span>] [<span style="color: #DFAF8F;">*</span>]<span style="color: #DFAF8F;">&lt;</span>mod<span style="color: #DFAF8F;">&gt;</span> <span style="color: #DFAF8F;">...</span>  set the context for expression evaluation
   <span style="color: #7CB8BB;">:</span>quit                       exit <span style="color: #7CB8BB;">GHCi</span>
   <span style="color: #7CB8BB;">:</span>reload[<span style="color: #DFAF8F;">!</span>]                  reload the current <span style="color: #F0DFAF; font-weight: bold;">module</span> set
                               (<span style="color: #DFAF8F;">!:</span> defer <span style="color: #F0DFAF; font-weight: bold;">type</span> errors)
   <span style="color: #7CB8BB;">:</span>run function [<span style="color: #DFAF8F;">&lt;</span>arguments<span style="color: #DFAF8F;">&gt;</span> <span style="color: #DFAF8F;">...</span>] run the function with the given arguments
   <span style="color: #7CB8BB;">:</span>script <span style="color: #DFAF8F;">&lt;</span>file<span style="color: #DFAF8F;">&gt;</span>              run the script <span style="color: #DFAF8F;">&lt;</span>file<span style="color: #DFAF8F;">&gt;</span>
   <span style="color: #7CB8BB;">:</span><span style="color: #F0DFAF; font-weight: bold;">type</span> <span style="color: #DFAF8F;">&lt;</span>expr<span style="color: #DFAF8F;">&gt;</span>                show the <span style="color: #F0DFAF; font-weight: bold;">type</span> <span style="color: #F0DFAF; font-weight: bold;">of</span> <span style="color: #DFAF8F;">&lt;</span>expr<span style="color: #DFAF8F;">&gt;</span>
   <span style="color: #7CB8BB;">:</span>undef <span style="color: #DFAF8F;">&lt;</span>cmd<span style="color: #DFAF8F;">&gt;</span>                undefine user<span style="color: #DFAF8F;">-</span>defined command <span style="color: #7CB8BB;">:&lt;</span>cmd<span style="color: #DFAF8F;">&gt;</span>
   <span style="color: #7CB8BB;">:!&lt;</span>command<span style="color: #DFAF8F;">&gt;</span>                 run the shell command <span style="color: #DFAF8F;">&lt;</span>command<span style="color: #DFAF8F;">&gt;</span>

 <span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Commands for debugging:</span>

   <span style="color: #7CB8BB;">:</span>abandon                    at a breakpoint, abandon current computation
   <span style="color: #7CB8BB;">:</span>back [<span style="color: #DFAF8F;">&lt;</span>n<span style="color: #DFAF8F;">&gt;</span>]                 go back <span style="color: #F0DFAF; font-weight: bold;">in</span> the history <span style="color: #7CB8BB;">N</span> steps (after <span style="color: #7CB8BB;">:</span>trace)
   <span style="color: #7CB8BB;">:</span>break [<span style="color: #DFAF8F;">&lt;</span>mod<span style="color: #DFAF8F;">&gt;</span>] <span style="color: #DFAF8F;">&lt;</span>l<span style="color: #DFAF8F;">&gt;</span> [<span style="color: #DFAF8F;">&lt;</span>col<span style="color: #DFAF8F;">&gt;</span>]  set a breakpoint at the specified location
   <span style="color: #7CB8BB;">:</span>break <span style="color: #DFAF8F;">&lt;</span>name<span style="color: #DFAF8F;">&gt;</span>               set a breakpoint on the specified function
   <span style="color: #7CB8BB;">:</span>continue                   resume after a breakpoint
   <span style="color: #7CB8BB;">:</span>delete <span style="color: #DFAF8F;">&lt;</span>number<span style="color: #DFAF8F;">&gt;</span>            delete the specified breakpoint
   <span style="color: #7CB8BB;">:</span>delete <span style="color: #DFAF8F;">*</span>                   delete all breakpoints
   <span style="color: #7CB8BB;">:</span>force <span style="color: #DFAF8F;">&lt;</span>expr<span style="color: #DFAF8F;">&gt;</span>               print <span style="color: #DFAF8F;">&lt;</span>expr<span style="color: #DFAF8F;">&gt;</span>, forcing unevaluated parts
   <span style="color: #7CB8BB;">:</span>forward [<span style="color: #DFAF8F;">&lt;</span>n<span style="color: #DFAF8F;">&gt;</span>]              go forward <span style="color: #F0DFAF; font-weight: bold;">in</span> the history <span style="color: #7CB8BB;">N</span> step s(after <span style="color: #7CB8BB;">:</span>back)
   <span style="color: #7CB8BB;">:</span>history [<span style="color: #DFAF8F;">&lt;</span>n<span style="color: #DFAF8F;">&gt;</span>]              after <span style="color: #7CB8BB;">:</span>trace, show the execution history
   <span style="color: #7CB8BB;">:</span>list                       show the source code around current breakpoint
   <span style="color: #7CB8BB;">:</span>list <span style="color: #DFAF8F;">&lt;</span>identifier<span style="color: #DFAF8F;">&gt;</span>          show the source code for <span style="color: #DFAF8F;">&lt;</span>identifier<span style="color: #DFAF8F;">&gt;</span>
   <span style="color: #7CB8BB;">:</span>list [<span style="color: #DFAF8F;">&lt;</span><span style="color: #F0DFAF; font-weight: bold;">module</span><span style="color: #DFAF8F;">&gt;</span>] <span style="color: #DFAF8F;">&lt;</span>line<span style="color: #DFAF8F;">&gt;</span>     show the source code around line number <span style="color: #DFAF8F;">&lt;</span>line<span style="color: #DFAF8F;">&gt;</span>
   <span style="color: #7CB8BB;">:</span>print [<span style="color: #DFAF8F;">&lt;</span>name<span style="color: #DFAF8F;">&gt;</span> <span style="color: #DFAF8F;">...</span>]         show a value without forcing its computation
   <span style="color: #7CB8BB;">:</span>sprint [<span style="color: #DFAF8F;">&lt;</span>name<span style="color: #DFAF8F;">&gt;</span> <span style="color: #DFAF8F;">...</span>]        simplified version <span style="color: #F0DFAF; font-weight: bold;">of</span> <span style="color: #7CB8BB;">:</span>print
   <span style="color: #7CB8BB;">:</span>step                       single<span style="color: #DFAF8F;">-</span>step after stopping at a breakpoint
   <span style="color: #7CB8BB;">:</span>step <span style="color: #DFAF8F;">&lt;</span>expr<span style="color: #DFAF8F;">&gt;</span>                single<span style="color: #DFAF8F;">-</span>step into <span style="color: #DFAF8F;">&lt;</span>expr<span style="color: #DFAF8F;">&gt;</span>
   <span style="color: #7CB8BB;">:</span>steplocal                  single<span style="color: #DFAF8F;">-</span>step within the current top<span style="color: #DFAF8F;">-</span>level binding
   <span style="color: #7CB8BB;">:</span>stepmodule                 single<span style="color: #DFAF8F;">-</span>step restricted to the current <span style="color: #F0DFAF; font-weight: bold;">module</span>
   <span style="color: #7CB8BB;">:</span>trace                      trace after stopping at a breakpoint
   <span style="color: #7CB8BB;">:</span>trace <span style="color: #DFAF8F;">&lt;</span>expr<span style="color: #DFAF8F;">&gt;</span>               evaluate <span style="color: #DFAF8F;">&lt;</span>expr<span style="color: #DFAF8F;">&gt;</span> with tracing on (see <span style="color: #7CB8BB;">:</span>history)

 <span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Commands for changing settings:</span>

   <span style="color: #7CB8BB;">:</span>set <span style="color: #DFAF8F;">&lt;</span>option<span style="color: #DFAF8F;">&gt;</span> <span style="color: #DFAF8F;">...</span>           set options
   <span style="color: #7CB8BB;">:</span>seti <span style="color: #DFAF8F;">&lt;</span>option<span style="color: #DFAF8F;">&gt;</span> <span style="color: #DFAF8F;">...</span>          set options for interactive evaluation only
   <span style="color: #7CB8BB;">:</span>set args <span style="color: #DFAF8F;">&lt;</span>arg<span style="color: #DFAF8F;">&gt;</span> <span style="color: #DFAF8F;">...</span>         set the arguments returned by System.getArgs
   <span style="color: #7CB8BB;">:</span>set prog <span style="color: #DFAF8F;">&lt;</span>progname<span style="color: #DFAF8F;">&gt;</span>        set the value returned by System.getProgName
   <span style="color: #7CB8BB;">:</span>set prompt <span style="color: #DFAF8F;">&lt;</span>prompt<span style="color: #DFAF8F;">&gt;</span>        set the prompt used <span style="color: #F0DFAF; font-weight: bold;">in</span> <span style="color: #7CB8BB;">GHCi</span>
   <span style="color: #7CB8BB;">:</span>set prompt2 <span style="color: #DFAF8F;">&lt;</span>prompt<span style="color: #DFAF8F;">&gt;</span>       set the continuation prompt used <span style="color: #F0DFAF; font-weight: bold;">in</span> <span style="color: #7CB8BB;">GHCi</span>
   <span style="color: #7CB8BB;">:</span>set editor <span style="color: #DFAF8F;">&lt;</span>cmd<span style="color: #DFAF8F;">&gt;</span>           set the command used for <span style="color: #7CB8BB;">:</span>edit
   <span style="color: #7CB8BB;">:</span>set stop [<span style="color: #DFAF8F;">&lt;</span>n<span style="color: #DFAF8F;">&gt;</span>] <span style="color: #DFAF8F;">&lt;</span>cmd<span style="color: #DFAF8F;">&gt;</span>       set the command to run when a breakpoint is hit
   <span style="color: #7CB8BB;">:</span>unset <span style="color: #DFAF8F;">&lt;</span>option<span style="color: #DFAF8F;">&gt;</span> <span style="color: #DFAF8F;">...</span>         unset options

  <span style="color: #7CB8BB;">Options</span> for <span style="color: #CC9393;">':set'</span> and <span style="color: #CC9393;">':unset'</span><span style="color: #7CB8BB;">:</span>

    <span style="color: #DFAF8F;">+</span>m            allow multiline commands
    <span style="color: #DFAF8F;">+</span>r            revert top<span style="color: #DFAF8F;">-</span>level expressions after each evaluation
    <span style="color: #DFAF8F;">+</span>s            print timing<span style="color: #DFAF8F;">/</span>memory stats after each evaluation
    <span style="color: #DFAF8F;">+</span>t            print <span style="color: #F0DFAF; font-weight: bold;">type</span> after evaluation
    <span style="color: #DFAF8F;">+</span>c            collect <span style="color: #F0DFAF; font-weight: bold;">type</span><span style="color: #DFAF8F;">/</span>location info after loading modules
    <span style="color: #DFAF8F;">-&lt;</span>flags<span style="color: #DFAF8F;">&gt;</span>      most <span style="color: #7CB8BB;">GHC</span> command line flags can also be set here
                         (eg<span style="color: #DFAF8F;">.</span> <span style="color: #DFAF8F;">-</span>v2, <span style="color: #DFAF8F;">-</span><span style="color: #7CB8BB;">XFlexibleInstances</span>, etc<span style="color: #DFAF8F;">.</span>)
                    for <span style="color: #7CB8BB;">GHCi</span><span style="color: #DFAF8F;">-</span>specific flags, see <span style="color: #7CB8BB;">User's</span> <span style="color: #7CB8BB;">Guide</span>,
                    <span style="color: #7CB8BB;">Flag</span> reference, <span style="color: #7CB8BB;">Interactive</span><span style="color: #DFAF8F;">-</span>mode options

 <span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Commands for displaying information:</span>

   <span style="color: #7CB8BB;">:</span>show bindings              show the current bindings made at the prompt
   <span style="color: #7CB8BB;">:</span>show breaks                show the active breakpoints
   <span style="color: #7CB8BB;">:</span>show context               show the breakpoint context
   <span style="color: #7CB8BB;">:</span>show imports               show the current imports
   <span style="color: #7CB8BB;">:</span>show linker                show current linker state
   <span style="color: #7CB8BB;">:</span>show modules               show the currently loaded modules
   <span style="color: #7CB8BB;">:</span>show packages              show the currently active package flags
   <span style="color: #7CB8BB;">:</span>show paths                 show the currently active search paths
   <span style="color: #7CB8BB;">:</span>show language              show the currently active language flags
   <span style="color: #7CB8BB;">:</span>show <span style="color: #DFAF8F;">&lt;</span>setting<span style="color: #DFAF8F;">&gt;</span>             show value <span style="color: #F0DFAF; font-weight: bold;">of</span> <span style="color: #DFAF8F;">&lt;</span>setting<span style="color: #DFAF8F;">&gt;</span>, which is one <span style="color: #F0DFAF; font-weight: bold;">of</span>
                                  [args, prog, prompt, editor, stop]
   <span style="color: #7CB8BB;">:</span>showi language             show language flags for interactive evaluation

</pre>
</div>
</div>
</div>
<div id="outline-container-org4a4f963" class="outline-3">
<h3 id="org4a4f963"><span class="section-number-3">1.7</span> IDE</h3>
<div class="outline-text-3" id="text-1-7">
</div><div id="outline-container-org380b753" class="outline-4">
<h4 id="org380b753"><span class="section-number-4">1.7.1</span> Hoogle</h4>
</div>
<div id="outline-container-org03af431" class="outline-4">
<h4 id="org03af431"><span class="section-number-4">1.7.2</span> Stack &amp; Stackage</h4>
</div>
</div>

<div id="outline-container-org7ed3a7e" class="outline-3">
<h3 id="org7ed3a7e"><span class="section-number-3">1.8</span> Čitanje poruka o grešci</h3>
<div class="outline-text-3" id="text-1-8">
<p>
Nemojte se plašiti poruka o grešci.
</p>

<p>
<b>GHC-ove poruke o grešci nisu duge nego su informativne.</b>
</p>

<p>
Poruke o grešci sadrže mnogo informacija iz kojih vidite zašto
nešto "nije po volji" kompajlera. Iz tih grešaka, ako umete da ih
čitate, možete da naučite bitne stvari.
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">x ++ "string"</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&lt;interactive&gt;:105:1: error:</span>
<span style="color: #5F7F5F;">--     </span><span style="color: #7F9F7F;">&#8226; Couldn't match expected type &#8216;[Char]&#8217; with actual type &#8216;Int&#8217;</span>
<span style="color: #5F7F5F;">--     </span><span style="color: #7F9F7F;">&#8226; In the first argument of &#8216;(++)&#8217;, namely &#8216;x&#8217;</span>
<span style="color: #5F7F5F;">--       </span><span style="color: #7F9F7F;">In the expression: x ++ "string"</span>
<span style="color: #5F7F5F;">--       </span><span style="color: #7F9F7F;">In an equation for &#8216;it&#8217;: it = x ++ "string"</span>
</pre>
</div>

<p>
Šta kaže ova greška?
</p>

<ul class="org-ul">
<li>Očeluje se <code>[Char]</code> tip, a nađen je <code>Int</code></li>
<li>kod prvog argumenta funkcije <code>(++)</code>, tačnije <code>x</code>.</li>
<li>u izrazu <code>x ++ "string"</code></li>
<li>u jednačini za (<code>it</code> je variabla koja će uvek imati vrednost
izraza koju ste predhodno uneli u GHCi): <code>it = x ++ "string"</code></li>
</ul>
</div>
</div>

<div id="outline-container-orge411d28" class="outline-3">
<h3 id="orge411d28"><span class="section-number-3">1.9</span> Ograničenja GHC kompajlera&#xa0;&#xa0;&#xa0;<span class="tag"><span class="za_radoznale">za_radoznale</span></span></h3>
<div class="outline-text-3" id="text-1-9">
</div><div id="outline-container-org5e15c28" class="outline-4">
<h4 id="org5e15c28"><span class="section-number-4">1.9.1</span> Monomorfizam restrikcija</h4>
<div class="outline-text-4" id="text-1-9-1">
<p>
<a href="https://wiki.haskell.org/Monomorphism_restriction">https://wiki.haskell.org/Monomorphism_restriction</a>
</p>
</div>
</div>
</div>

<div id="outline-container-orga577f51" class="outline-3">
<h3 id="orga577f51"><span class="section-number-3">1.10</span> Zadaci 1</h3>
<div class="outline-text-3" id="text-1-10">
<p>
Na kursu <a href="http://www.seas.upenn.edu/~cis194/spring13/hw/01-intro.pdf">cis194</a> su data dva zadatka, smatram ih vrlo ilustrativnim
za uvod u Haskell :)
</p>

<ol class="org-ol">
<li>Napisati funkciju <code>validate</code> za validiranje broja platne kartice</li>
<li>Napisati funkciju <code>hanoi</code> koja prima broj diskova <a href="https://en.wikipedia.org/wiki/Tower_of_Hanoi">Hanoi</a> tornjeva
i daje listu poteza koje treba preduzeti da bi se diskovi
pravilno preneli sa jednog na drugi toranj.</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org45c8b8c" class="outline-2">
<h2 id="org45c8b8c"><span class="section-number-2">2</span> Funkcije</h2>
</div>
<div id="outline-container-orgb9e2c69" class="outline-2">
<h2 id="orgb9e2c69"><span class="section-number-2">3</span> Tipovi</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-org0a370d9" class="outline-3">
<h3 id="org0a370d9"><span class="section-number-3">3.1</span> <code>nešto :: tip</code>, sve ima tip</h3>
</div>
<div id="outline-container-orge83eaa3" class="outline-3">
<h3 id="orge83eaa3"><span class="section-number-3">3.2</span> Kinds</h3>
<div class="outline-text-3" id="text-3-2">
<p>
<a href="https://jeltsch.wordpress.com/2013/02/09/some-interesting-features-of-haskells-type-system/">https://jeltsch.wordpress.com/2013/02/09/some-interesting-features-of-haskells-type-system/</a>
</p>
</div>
</div>
</div>

<div id="outline-container-orgc622c3b" class="outline-2">
<h2 id="orgc622c3b"><span class="section-number-2">4</span> Data deklaracije</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-orgdec8474" class="outline-3">
<h3 id="orgdec8474"><span class="section-number-3">4.1</span> Data konstruktor &amp; value konstruktor</h3>
<div class="outline-text-3" id="text-4-1">
</div><div id="outline-container-orgda61ed0" class="outline-4">
<h4 id="orgda61ed0"><span class="section-number-4">4.1.1</span> Records sintaksa</h4>
</div>
</div>
<div id="outline-container-orgeb75949" class="outline-3">
<h3 id="orgeb75949"><span class="section-number-3">4.2</span> <code>newtype</code></h3>
</div>
<div id="outline-container-org0d516c0" class="outline-3">
<h3 id="org0d516c0"><span class="section-number-3">4.3</span> <code>type</code></h3>
</div>
</div>

<div id="outline-container-orga632a58" class="outline-2">
<h2 id="orga632a58"><span class="section-number-2">5</span> Haskell &#x2014; lazy by default</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-org56f6d56" class="outline-3">
<h3 id="org56f6d56"><span class="section-number-3">5.1</span> <i>Strict evaluation vs. lazy evaluation</i></h3>
<div class="outline-text-3" id="text-5-1">
</div><div id="outline-container-orgafae8d9" class="outline-4">
<h4 id="orgafae8d9"><span class="section-number-4">5.1.1</span> Cena <i>strict</i> izračunavanja</h4>
</div>

<div id="outline-container-org0e960c9" class="outline-4">
<h4 id="org0e960c9"><span class="section-number-4">5.1.2</span> Cena <i>lazy</i> izračunavanja</h4>
</div>
</div>

<div id="outline-container-orge9081f5" class="outline-3">
<h3 id="orge9081f5"><span class="section-number-3">5.2</span> Haskell <i>laziness look and feel</i> vs. Java <i>Supliers</i> ("<i>type level laziness</i>")</h3>
<div class="outline-text-3" id="text-5-2">
<p>
Java je na <a href="https://www.sitepoint.com/java-in-praise-of-laziness/">SitePoint-u</a>. Haskell je na <a href="http://www.seas.upenn.edu/~cis194/spring13/lectures/06-laziness.html">CIS-u</a>.
</p>
</div>
</div>
</div>

<div id="outline-container-orgba7563a" class="outline-2">
<h2 id="orgba7563a"><span class="section-number-2">6</span> Polimorfizam</h2>
</div>
<div id="outline-container-orgc7eb33d" class="outline-2">
<h2 id="orgc7eb33d"><span class="section-number-2">7</span> GADTs</h2>
</div>
<div id="outline-container-orgced3976" class="outline-2">
<h2 id="orgced3976"><span class="section-number-2">8</span> Type Classes</h2>
<div class="outline-text-2" id="text-8">
</div><div id="outline-container-org06ee300" class="outline-3">
<h3 id="org06ee300"><span class="section-number-3">8.1</span> Automatsko instanciranje sa <code>deriving</code></h3>
</div>

<div id="outline-container-org4af5ca5" class="outline-3">
<h3 id="org4af5ca5"><span class="section-number-3">8.2</span> <code>class</code> NIJE <code>class</code> iz Pythona i Jave</h3>
<div class="outline-text-3" id="text-8-2">
<p>
Ono što je <code>type class</code> u Haskell-u to je sličnije abstraktnim
klasama u Javi i Pythonu.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>haskellNTP/showcase/src/Hierarchies.hs</label><pre class="src src-haskell"><span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Novi tipovi</span>
<span style="color: #F0DFAF; font-weight: bold;">data</span> <span style="color: #7CB8BB;">UnderGStudent</span> <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">UnderGStudent</span>
  { uGHunamInfo   <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">HumanInfo</span>
  , uGStudentInfo <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">StudentInfo</span>
  } <span style="color: #F0DFAF; font-weight: bold;">deriving</span> (<span style="color: #7CB8BB;">Show</span>)

<span style="color: #F0DFAF; font-weight: bold;">data</span> <span style="color: #7CB8BB;">PhDStudent</span> <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">PhDStudent</span>
  { phDHumanInfo   <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">HumanInfo</span>
  , phDStudentInfo <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">StudentInfo</span>
  , thesis         <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">String</span>
  } <span style="color: #F0DFAF; font-weight: bold;">deriving</span> (<span style="color: #7CB8BB;">Show</span>)

<span style="color: #F0DFAF; font-weight: bold;">data</span> <span style="color: #7CB8BB;">StudentInfo</span> <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">StudentInfo</span>
  { index <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Int</span>
  } <span style="color: #F0DFAF; font-weight: bold;">deriving</span> (<span style="color: #7CB8BB;">Show</span>)

<span style="color: #F0DFAF; font-weight: bold;">data</span> <span style="color: #7CB8BB;">HumanInfo</span> <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">HumanInfo</span>
  { name      <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">String</span>
  , surname   <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">String</span>
  , birthYear <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Int</span>
  } <span style="color: #F0DFAF; font-weight: bold;">deriving</span> (<span style="color: #7CB8BB;">Show</span>)

<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Ljudi su ljudi jer se mu&#269;e, to ih &#269;ini ljudima</span>
<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Human</span> a <span style="color: #F0DFAF; font-weight: bold;">where</span>
  struggle <span style="color: #DFAF8F;">::</span> a <span style="color: #DFAF8F;">-&gt;</span> <span style="color: #7CB8BB;">String</span>
  <span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Podrazumevana implementacija</span>
  struggle <span style="color: #DFAF8F;">=</span> const <span style="color: #CC9393;">"A poor man is struggling."</span>

<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Predava&#269;i su pre svega ljudi, a potom moraju znati i da se</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">predstave</span>
<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Human</span> a <span style="color: #DFAF8F;">=&gt;</span> <span style="color: #7CB8BB;">Lecturer</span> a <span style="color: #F0DFAF; font-weight: bold;">where</span>
  introduce <span style="color: #DFAF8F;">::</span> a <span style="color: #DFAF8F;">-&gt;</span> <span style="color: #7CB8BB;">String</span>

<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">UnderGStudent instanca &#269;oveka, UnderGStudent je &#269;ovek</span>
<span style="color: #F0DFAF; font-weight: bold;">instance</span> <span style="color: #7CB8BB;">Human</span> <span style="color: #7CB8BB;">UnderGStudent</span> <span style="color: #F0DFAF; font-weight: bold;">where</span>
  struggle (<span style="color: #7CB8BB;">UnderGStudent</span> (<span style="color: #7CB8BB;">HumanInfo</span> n <span style="color: #F0DFAF; font-weight: bold;">_</span> <span style="color: #F0DFAF; font-weight: bold;">_</span>) <span style="color: #F0DFAF; font-weight: bold;">_</span>) <span style="color: #DFAF8F;">=</span> n <span style="color: #DFAF8F;">++</span> <span style="color: #CC9393;">" is gravely struggling."</span>

<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">PhDStudent instanca &#269;oveka, PhDStudent je &#269;ovek</span>
<span style="color: #F0DFAF; font-weight: bold;">instance</span> <span style="color: #7CB8BB;">Human</span> <span style="color: #7CB8BB;">PhDStudent</span>

<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">PhdStudent instanca predava&#269;a</span>
<span style="color: #F0DFAF; font-weight: bold;">instance</span> <span style="color: #7CB8BB;">Lecturer</span> <span style="color: #7CB8BB;">PhDStudent</span> <span style="color: #F0DFAF; font-weight: bold;">where</span>
  introduce (<span style="color: #7CB8BB;">PhDStudent</span> (<span style="color: #7CB8BB;">HumanInfo</span> n <span style="color: #F0DFAF; font-weight: bold;">_</span> <span style="color: #F0DFAF; font-weight: bold;">_</span>) <span style="color: #F0DFAF; font-weight: bold;">_</span> t) <span style="color: #DFAF8F;">=</span>
    <span style="color: #CC9393;">"I am "</span> <span style="color: #DFAF8F;">++</span> n <span style="color: #DFAF8F;">++</span> <span style="color: #CC9393;">" and my research is directed towards "</span> <span style="color: #DFAF8F;">++</span> t <span style="color: #DFAF8F;">++</span> <span style="color: #CC9393;">"."</span>

<span style="color: #5F7F5F;">--</span><span style="color: #7F9F7F;">------------------------------------------------------------------------------</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Primeri:</span>

<span style="color: #93E0E3;">pera</span> <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">UnderGStudent</span> (<span style="color: #7CB8BB;">HumanInfo</span> <span style="color: #CC9393;">"Petar"</span> <span style="color: #CC9393;">"Petrovic"</span> 1987) (<span style="color: #7CB8BB;">StudentInfo</span> 8791)
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; name . uGHunamInfo $ pera</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">"Petar"</span>
<span style="color: #5F7F5F;">--</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; struggle pera</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">"Petar is gravely struggling."</span>

<span style="color: #93E0E3;">zika</span> <span style="color: #DFAF8F;">=</span>
  <span style="color: #7CB8BB;">PhDStudent</span>
    (<span style="color: #7CB8BB;">HumanInfo</span> <span style="color: #CC9393;">"Zika"</span> <span style="color: #CC9393;">"Zikic"</span> 1983)
    (<span style="color: #7CB8BB;">StudentInfo</span> 123)
    <span style="color: #CC9393;">"functional programming"</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; name . phDHumanInfo $ zika</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">"Zika"</span>
<span style="color: #5F7F5F;">--</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; thesis zika</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">"functional programming"</span>
<span style="color: #5F7F5F;">--</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">PhDStudent koristi default-nu implementaciju struggle funkcije</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; struggle zika</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">"A poor man is struggling."</span>
<span style="color: #5F7F5F;">--</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; introduce zika</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">"I am Zika and my research is directed towards functional programming."</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org710f5d0" class="outline-3">
<h3 id="org710f5d0"><span class="section-number-3">8.3</span> <i>fundeps</i> (Functional Dependencies)</h3>
<div class="outline-text-3" id="text-8-3">
<p>
<a href="https://wiki.haskell.org/Functional_dependencies"><i>Fundeps</i></a> se koriste da daju dodatna međusobna ograničenja
parametara klasa. U klasama sa više parametara daju mogućnost da se
tipovi parametara zaključuju na osnovu tipova drugih parametara.
</p>

<p>
Jedan naivan prikaz problema kog rešavaju <i>fundeps</i>:
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 2: </span>haskellNTP/showcase/src/FunDeps.hs</label><pre class="src src-haskell"><span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Abstrakcija raspakivanja</span>
<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Unpack</span> packaging content  <span style="color: #F0DFAF; font-weight: bold;">where</span>
  unpack <span style="color: #DFAF8F;">::</span> packaging <span style="color: #DFAF8F;">-&gt;</span> content

<span style="color: #F0DFAF; font-weight: bold;">data</span> <span style="color: #7CB8BB;">Carton</span> <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">Carton</span>
  { volume <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Double</span>
  } <span style="color: #F0DFAF; font-weight: bold;">deriving</span> (<span style="color: #7CB8BB;">Eq</span>, <span style="color: #7CB8BB;">Show</span>)

<span style="color: #F0DFAF; font-weight: bold;">data</span> <span style="color: #7CB8BB;">Milk</span> <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">Milk</span>
  { kind <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">String</span>
  , desc <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">String</span>
  } <span style="color: #F0DFAF; font-weight: bold;">deriving</span> (<span style="color: #7CB8BB;">Show</span>)

<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Carton i Milk instanca raspakivanja, kada se raspakuje mleko iz</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">kartona</span>
<span style="color: #F0DFAF; font-weight: bold;">instance</span> <span style="color: #7CB8BB;">Unpack</span> <span style="color: #7CB8BB;">Carton</span> <span style="color: #7CB8BB;">Milk</span> <span style="color: #F0DFAF; font-weight: bold;">where</span>
  unpack p <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">Milk</span> <span style="color: #CC9393;">"cow milk"</span> <span style="color: #DFAF8F;">$</span> <span style="color: #CC9393;">"carton of "</span> <span style="color: #DFAF8F;">++</span> (show <span style="color: #DFAF8F;">.</span> volume <span style="color: #DFAF8F;">$</span> p) <span style="color: #DFAF8F;">++</span> <span style="color: #CC9393;">" volume."</span>

<span style="color: #93E0E3;">c</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Carton</span>
<span style="color: #93E0E3;">c</span> <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">Carton</span> 500

<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">try = unpack c</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">src/FunDeps.hs:25:7-14: error: &#8230;</span>
<span style="color: #5F7F5F;">--     </span><span style="color: #7F9F7F;">&#8226; Ambiguous type variable &#8216;content0&#8217; arising from a use of &#8216;unpack&#8217;</span>
<span style="color: #5F7F5F;">--       </span><span style="color: #7F9F7F;">prevents the constraint &#8216;(Unpack</span>
<span style="color: #5F7F5F;">--                                   </span><span style="color: #7F9F7F;">Carton content0)&#8217; from being solved.</span>
<span style="color: #5F7F5F;">--       </span><span style="color: #7F9F7F;">Relevant bindings include</span>
<span style="color: #5F7F5F;">--         </span><span style="color: #7F9F7F;">try :: content0</span>
<span style="color: #5F7F5F;">--           </span><span style="color: #7F9F7F;">(bound at haskellNTP/showcase/src/FunDeps.hs:25:1)</span>
<span style="color: #5F7F5F;">--       </span><span style="color: #7F9F7F;">Probable fix: use a type annotation to specify what &#8216;content0&#8217; should b</span><span style="color: #DC8CC3; background-color: #3F3F3F;">e.</span>
<span style="color: #5F7F5F;">--       </span><span style="color: #7F9F7F;">These potential instance exist:</span>
<span style="color: #5F7F5F;">--         </span><span style="color: #7F9F7F;">instance Unpack Carton Milk</span>
<span style="color: #5F7F5F;">--           </span><span style="color: #7F9F7F;">-- Defined at haskellNTP/showcase/src/FunDeps.hs:19:10</span>
<span style="color: #5F7F5F;">--     </span><span style="color: #7F9F7F;">&#8226; In the expression: unpack c</span>
<span style="color: #5F7F5F;">--       </span><span style="color: #7F9F7F;">In an equation for &#8216;try&#8217;: try = unpack c</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Compilation failed.</span>
</pre>
</div>

<p>
Kompajler prosto ne može da zna kog je tipa izraz <code>unpack c</code>.
</p>

<p>
<b>Zašto?</b>
</p>

<p>
Pokušajmo da reprodukujemo kako kompajler "razmišlja" na osnovu
greške koju nam je dao.
</p>

<p>
Prvo nam kaže da smo bili dvosmisleni pri korišćenju <code>unpack</code>
funkcije jer on ne može da repreodukuje kako <b>tačno</b> izgleda klasa
te funkcije. Jasno mu je da je ta klasa nešto nalik <code>(Unpack Carton
   content0)</code> ali ga muči taj <code>content0</code> jer za njega ne ume da kaže
kog je tipa:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">src/FunDeps.hs:25:7-14: error: &#8230;</span>
<span style="color: #5F7F5F;">--     </span><span style="color: #7F9F7F;">&#8226; Ambiguous type variable &#8216;content0&#8217; arising from a use of &#8216;unpack&#8217;</span>
<span style="color: #5F7F5F;">--       </span><span style="color: #7F9F7F;">prevents the constraint &#8216;(Unpack</span>
<span style="color: #5F7F5F;">--                                   </span><span style="color: #7F9F7F;">Carton content0)&#8217; from being solved.</span>
</pre>
</div>

<p>
I onda traži od nas da mu pomognemo. Kaže da bismo mi možda mogli
da mu pomognemo tako što ćemo reći kog je tipa izraz <code>unpack c</code> pa
će on onda umeti da shvati kako tačno izgleda klasa iz koje je ta
funkcija:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #5F7F5F;">--       </span><span style="color: #7F9F7F;">Probable fix: use a type annotation to specify what &#8216;content0&#8217; should b</span><span style="color: #DC8CC3; background-color: #3F3F3F;">e.</span>
</pre>
</div>

<p>
I na kraju nam još pokazuje kako razmišlja tako što nam kaže da je
tražio <b>sve moguće instance</b> te sumnjive klase <code>Unpack</code> (i našao je
jednu).
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #5F7F5F;">--       </span><span style="color: #7F9F7F;">These potential instance exist:</span>
<span style="color: #5F7F5F;">--         </span><span style="color: #7F9F7F;">instance Unpack Carton Milk</span>
<span style="color: #5F7F5F;">--           </span><span style="color: #7F9F7F;">-- Defined at haskellNTP/showcase/src/FunDeps.hs:19:10</span>
</pre>
</div>

<p>
Možda bismo se mogli <span class="underline">izleteti</span> i uzviknuti:
</p>

<p>
<b>Pa eto mu odgovora. Piše u toj instanci kog je tipa <code>unpack c</code>
(naravno da je <code>Milk</code>)!</b>
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #F0DFAF; font-weight: bold;">instance</span> <span style="color: #7CB8BB;">Unpack</span> <span style="color: #7CB8BB;">Carton</span> <span style="color: #7CB8BB;">Milk</span> <span style="color: #F0DFAF; font-weight: bold;">where</span>
  unpack p <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">Milk</span> <span style="color: #CC9393;">"cow milk"</span> <span style="color: #DFAF8F;">$</span> <span style="color: #CC9393;">"carton of "</span> <span style="color: #DFAF8F;">++</span> (show <span style="color: #DFAF8F;">.</span> volume <span style="color: #DFAF8F;">$</span> p) <span style="color: #DFAF8F;">++</span> <span style="color: #CC9393;">" volume."</span>
</pre>
</div>

<p>
Međutim pogrešili bismo ( <span class="underline">naravno</span> ).
</p>

<p>
<b>Zašto?</b>
</p>

<p>
Zato što se naknadno može dodati nova instanca <code>Unpack</code> klase. ♦
</p>

<p>
Na primer:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #F0DFAF; font-weight: bold;">data</span> <span style="color: #7CB8BB;">Yogurt</span> <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">Yogurt</span>
  { density <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">String</span>
  } <span style="color: #F0DFAF; font-weight: bold;">deriving</span> (<span style="color: #7CB8BB;">Show</span>)

<span style="color: #F0DFAF; font-weight: bold;">instance</span> <span style="color: #7CB8BB;">Unpack</span> <span style="color: #7CB8BB;">Carton</span> <span style="color: #7CB8BB;">Yogurt</span> <span style="color: #F0DFAF; font-weight: bold;">where</span>
  unpack c <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">Yogurt</span> <span style="color: #DFAF8F;">$</span> <span style="color: #CC9393;">"rare yogurt in carton of "</span> <span style="color: #DFAF8F;">++</span> (show <span style="color: #DFAF8F;">.</span> volume <span style="color: #DFAF8F;">$</span> c) <span style="color: #DFAF8F;">++</span> <span style="color: #CC9393;">"."</span>
</pre>
</div>

<p>
<b>Rešenje:</b>
</p>

<p>
Možemo poslušati kompjler i eksplicitno dati tip izrazu:
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; unpack c :: Yogurt</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Yogurt {density = "rare yogurt in carton of 500.0."}</span>
</pre>
</div>

<p>
Možemo iskoristiti <a href="https://prime.haskell.org/wiki/FlexibleInstances">FlexibleInstances</a> dodatak jeziku:
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; :set -XFlexibleContexts</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; unpack c</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">unpack c :: Unpack Carton content =&gt; content</span>
</pre>
</div>

<p>
I možemo koristi <i>fundeps</i>:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Unpack'</span> packaging content  <span style="color: #DFAF8F;">|</span> packaging <span style="color: #DFAF8F;">-&gt;</span> content <span style="color: #F0DFAF; font-weight: bold;">where</span>
  unpack' <span style="color: #DFAF8F;">::</span> packaging <span style="color: #DFAF8F;">-&gt;</span> content

<span style="color: #F0DFAF; font-weight: bold;">instance</span> <span style="color: #7CB8BB;">Unpack'</span> <span style="color: #7CB8BB;">Carton</span> <span style="color: #7CB8BB;">Milk</span> <span style="color: #F0DFAF; font-weight: bold;">where</span>
  unpack' p <span style="color: #DFAF8F;">=</span>
    <span style="color: #7CB8BB;">Milk</span> <span style="color: #CC9393;">"cow milk"</span> <span style="color: #DFAF8F;">$</span> <span style="color: #CC9393;">"carton of "</span> <span style="color: #DFAF8F;">++</span> (show <span style="color: #DFAF8F;">.</span> volume <span style="color: #DFAF8F;">$</span> p) <span style="color: #DFAF8F;">++</span> <span style="color: #CC9393;">" volume."</span>

<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; unpack' c</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Milk {kind = "cow milk", desc = "carton of 500.0 volume."}</span>
</pre>
</div>

<p>
Sada smo u zaglavlju klase <code>Unpack'</code> rekli da:
</p>

<p>
<b>Za jedan <code>packaging</code> tip može biti samo jedan <code>content</code> tip</b>.
</p>

<p>
I nema nikakve dileme kog je tipa <code>unpack' c</code> jer <b>ne može</b>
postojati još jedna instanca klase <code>Unpack'</code> koja bi pravila
problem:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #F0DFAF; font-weight: bold;">data</span> <span style="color: #7CB8BB;">EnergyDrink</span> <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">EnergyDrink</span>
  { caffeineRate <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">Int</span>
  } <span style="color: #F0DFAF; font-weight: bold;">deriving</span> (<span style="color: #7CB8BB;">Show</span>)

<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">instance Unpack' GlassBottle EnergyDrink where</span>
<span style="color: #5F7F5F;">--   </span><span style="color: #7F9F7F;">unpack' p = EnergyDrink 12</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">src/FunDeps.hs:78:10-33: error: &#8230;</span>
<span style="color: #5F7F5F;">--     </span><span style="color: #7F9F7F;">Functional dependencies conflict between instance declarations:</span>
<span style="color: #5F7F5F;">--       </span><span style="color: #7F9F7F;">instance Unpack' GlassBottle Beer</span>
<span style="color: #5F7F5F;">--         </span><span style="color: #7F9F7F;">-- Defined at /home/novak/haskell/haskellNTP/showcase/src/FunDeps.hs:</span><span style="color: #DC8CC3; background-color: #3F3F3F;">78:10</span>
<span style="color: #5F7F5F;">--       </span><span style="color: #7F9F7F;">instance Unpack' GlassBottle EnergyDrink</span>
<span style="color: #5F7F5F;">--         </span><span style="color: #7F9F7F;">-- Defined at /home/novak/haskell/haskellNTP/showcase/src/FunDeps.hs:</span><span style="color: #DC8CC3; background-color: #3F3F3F;">90:10</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Compilation failed.</span>
</pre>
</div>

<p>
Naravno, u neku drugu ambalažu se može bez problema pakovati nešto
drugo, to svakako neće praviti problem:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #F0DFAF; font-weight: bold;">data</span> <span style="color: #7CB8BB;">GlassBottle</span> <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">GlassBottle</span>
  { shape <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">String</span>
  } <span style="color: #F0DFAF; font-weight: bold;">deriving</span> (<span style="color: #7CB8BB;">Show</span>)

<span style="color: #F0DFAF; font-weight: bold;">data</span> <span style="color: #7CB8BB;">Beer</span> <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">Beer</span>
  { feel <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">String</span>
  } <span style="color: #F0DFAF; font-weight: bold;">deriving</span> (<span style="color: #7CB8BB;">Show</span>)

<span style="color: #F0DFAF; font-weight: bold;">instance</span> <span style="color: #7CB8BB;">Unpack'</span> <span style="color: #7CB8BB;">GlassBottle</span> <span style="color: #7CB8BB;">Beer</span> <span style="color: #F0DFAF; font-weight: bold;">where</span>
  unpack' p <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">Beer</span> <span style="color: #DFAF8F;">$</span> <span style="color: #CC9393;">"Fresh bear from the "</span> <span style="color: #DFAF8F;">++</span> shape p <span style="color: #DFAF8F;">++</span> <span style="color: #CC9393;">"."</span>

<span style="color: #93E0E3;">b</span> <span style="color: #DFAF8F;">=</span> <span style="color: #7CB8BB;">GlassBottle</span> <span style="color: #CC9393;">"curvy bottle"</span>

<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">&#955;&gt; unpack' b</span>
<span style="color: #5F7F5F;">-- </span><span style="color: #7F9F7F;">Beer {feel = "Fresh bear from the curvy bottle."}</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc7b77f8" class="outline-2">
<h2 id="orgc7b77f8"><span class="section-number-2">9</span> Monoidi</h2>
</div>
<div id="outline-container-org5c82cdd" class="outline-2">
<h2 id="org5c82cdd"><span class="section-number-2">10</span> Funktori</h2>
</div>
<div id="outline-container-org11bac45" class="outline-2">
<h2 id="org11bac45"><span class="section-number-2">11</span> Aplikativni funktori</h2>
</div>
<div id="outline-container-org4f6c592" class="outline-2">
<h2 id="org4f6c592"><span class="section-number-2">12</span> Monade</h2>
<div class="outline-text-2" id="text-12">
</div><div id="outline-container-orgfd5bc45" class="outline-3">
<h3 id="orgfd5bc45"><span class="section-number-3">12.1</span> IO</h3>
</div>
</div>
<div id="outline-container-org0b34ea0" class="outline-2">
<h2 id="org0b34ea0"><span class="section-number-2">13</span> Profiling</h2>
<div class="outline-text-2" id="text-13">
<p>
<b>Zašto je ovaj program spor?</b>
</p>

<p>
<b>Zašto ovaj program koristi ovoliko memorije?</b>
</p>

<p>
<a href="https://en.wikipedia.org/wiki/Profiling_(computer_programming)">Profiling</a> je dinamička ili statička analiza programa koja služi da
izmeri koliko i kako program troši resurse. Informacije koje daju
profiler-i koriste se za optimizaciju.
</p>

<p>
Kod funkcionalnih jezika osnovni nivo profiling-a odnosi se na
merenje potrošnje resursa koju program pravi pri pozivu pojedinih
funkcija.
</p>

<p>
<b>Haskell funkcija A koristi funkciju A1</b> <br />
<b>Haskell funkcija A1 koristi funkciju A2</b> <br />
<b>Haskell funkcija B koristi funkciju B1</b> <br />
<b>Haskell funkcija B1 koristi funkciju B2</b> <br />
<b>Haskell funkcija A1 je spora i troši previše memorije. Šta nam
garantuje da to nije zbog B1?</b>
</p>
</div>

<div id="outline-container-orgdcfa1e2" class="outline-3">
<h3 id="orgdcfa1e2"><span class="section-number-3">13.1</span> Primitivni profiling samo sa Unix <code>time</code></h3>
</div>
<div id="outline-container-org447b7f4" class="outline-3">
<h3 id="org447b7f4"><span class="section-number-3">13.2</span> GHC podrška za profiling</h3>
<div class="outline-text-3" id="text-13-2">
<p>
Izvodi se u tri koraka:
</p>

<ol class="org-ol">
<li><p>
Kompajliranje programa za profiling
</p>

<p>
GHC ubaci delove koda koji nam omogućavaju da u vreme
izvršavanja dobijamo informacije za profiling. To se mora
naglasiti posebnim opcijama koje se daju kompajleru (pun spisak
opcija potražiti <a href="https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/profiling.html">ovde</a>):
</p>

<div class="org-src-container">
<pre class="src src-shell">ghc -prof -fprof-auto-top -rtsopts Modul.hs
</pre>
</div>

<p>
Moguće je ubaciti odgovarajuću pragmu (<i>cost centre annotation</i>)
na mesta u porgramu koja posebno želimo da "merimo":
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #94BFF3;">{-# SCC ime_za_merenje #-}</span>
</pre>
</div>

<p>
Primer programa koji koristi eksplicitne <i>cost</i> centre je dat u
nastavku:
</p>

<p>
<a id="org5287062"></a>
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 3: </span>haskellNTP/profiling/src/ExplicitCostCenters.hs</label><pre class="src src-haskell"><span style="color: #93E0E3;">explicitCostCenters</span> <span style="color: #DFAF8F;">::</span> <span style="color: #7CB8BB;">IO</span> <span style="color: #7CB8BB;">()</span>
<span style="color: #93E0E3;">explicitCostCenters</span> <span style="color: #DFAF8F;">=</span> <span style="color: #F0DFAF; font-weight: bold;">do</span> print <span style="color: #DFAF8F;">$</span> <span style="color: #94BFF3;">{-# SCC last_xs #-}</span> last xs
                         print <span style="color: #DFAF8F;">$</span> <span style="color: #94BFF3;">{-# SCC last_init_xs #-}</span> last <span style="color: #DFAF8F;">$</span> init xs
                         print <span style="color: #DFAF8F;">$</span> <span style="color: #94BFF3;">{-# SCC last_ys #-}</span> last ys
                         print <span style="color: #DFAF8F;">$</span> <span style="color: #94BFF3;">{-# SCC last_init_ys #-}</span> last <span style="color: #DFAF8F;">$</span> init ys
                           <span style="color: #F0DFAF; font-weight: bold;">where</span> xs <span style="color: #DFAF8F;">=</span> [1<span style="color: #DFAF8F;">..</span>1000000]
                                 ys <span style="color: #DFAF8F;">=</span> [1<span style="color: #DFAF8F;">..</span>2000000]
</pre>
</div>

<p>
Kako bi ovakva mesta u programu bila merena potrebno je da pri
kompajliranju <a href="https://downloads.haskell.org/~ghc/7.8.2/docs/html/users_guide/prof-compiler-options.html">bude omogućena opcija <code>-prof</code></a>.
</p>

<p>
Ako projekat koristi <i>stack</i> sličan efekat komandi gore se može
postići na sledeći način (imajte u vidu da <code>Stack</code> koristi
<code>Cabal</code> a tek <code>Cabal</code> prosleđuje opcije GHC-u, pogledati <a href="https://github.com/commercialhaskell/stack/blob/master/doc/GUIDE.md#debugging">ovde</a>):
</p>

<div class="org-src-container">
<pre class="src src-shell">stack build --library-profiling --executable-profiling <span style="color: #CC9393;">\</span>
      --ghc-options=<span style="color: #CC9393;">"-fno-prof-cafs -rtsopts"</span>
</pre>
</div></li>

<li><p>
Pokretanje programa sa omogućenim opcijama za profiling
</p>

<div class="org-src-container">
<pre class="src src-shell">./projekat-exe +RTS -p
</pre>
</div>

<p>
Pun spisak <i>RTS</i> opcija možete pogledati <a href="https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/profiling.html#time-and-allocation-profiling">ovde</a>.
</p>

<p>
Ako koristite <i>stack</i>:
</p>

<div class="org-src-container">
<pre class="src src-shell">stack exec -- projekat-exe +RTS -p
</pre>
</div></li>

<li><p>
Analiza rezultata
</p>

<p>
Ako ste program izvršili sa RTS opcijom <code>-p</code> onda ste dobili
fajl <code>program.prof</code> u kome se nalaze rezultati za analizu.
</p>

<p>
Ako izvršimo prethodna dva koraka sa programom datim <a href="#org5287062">ranije</a> naš
<code>.prof</code> file će ličiti na:
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 4: </span>haskellNTP/profiling/profiling-exe-manual-CAFS.prof</label><pre class="src src-fundamental">        Mon Mar  6 14:59 2017 Time and Allocation Profiling Report  (Final)

           profiling-exe +RTS -N -p -RTS

        total time  =        0.16 secs   (163 ticks @ 1000 us, 1 processor)
        total alloc = 384,079,344 bytes  (excludes profiling overheads)

COST CENTRE  MODULE SRC                   %time %alloc

main.ys      Main   app/Main.hs:28:17-33   42.3   37.5
last_init_ys Main   app/Main.hs:26:44-57   20.9   29.2
main.xs      Main   app/Main.hs:27:17-33   18.4   18.7
last_init_xs Main   app/Main.hs:24:44-57   11.0   14.6
last_ys      Main   app/Main.hs:25:39-45    3.7    0.0
last_xs      Main   app/Main.hs:23:39-45    3.1    0.0


                                                                                    individual      inherited
COST CENTRE     MODULE                SRC                        no.     entries  %time %alloc   %time %alloc

MAIN            MAIN                  &lt;built-in&gt;                  46          0    0.6    0.0   100.0  100.0
 CAF            Main                  &lt;entire-module&gt;             91          0    0.0    0.0    99.4  100.0
  main          Main                  app/Main.hs:(23,1)-(28,33)  92          1    0.0    0.0    99.4  100.0
   last_init_xs Main                  app/Main.hs:24:44-57        96          1   11.0   14.6    11.0   14.6
   last_init_ys Main                  app/Main.hs:26:44-57        99          1   20.9   29.2    20.9   29.2
   last_xs      Main                  app/Main.hs:23:39-45        94          1    3.1    0.0     3.1    0.0
   last_ys      Main                  app/Main.hs:25:39-45        97          1    3.7    0.0     3.7    0.0
   main.xs      Main                  app/Main.hs:27:17-33        95          1   18.4   18.7    18.4   18.7
   main.ys      Main                  app/Main.hs:28:17-33        98          1   42.3   37.5    42.3   37.5
 CAF            GHC.IO.Handle.FD      &lt;entire-module&gt;             88          0    0.0    0.0     0.0    0.0
 CAF            GHC.Event.Thread      &lt;entire-module&gt;             86          0    0.0    0.0     0.0    0.0
 CAF            GHC.IO.Encoding       &lt;entire-module&gt;             85          0    0.0    0.0     0.0    0.0
 CAF            GHC.IO.Handle.Text    &lt;entire-module&gt;             84          0    0.0    0.0     0.0    0.0
 CAF            GHC.Conc.Signal       &lt;entire-module&gt;             81          0    0.0    0.0     0.0    0.0
 CAF            GHC.Event.Poll        &lt;entire-module&gt;             74          0    0.0    0.0     0.0    0.0
 CAF            GHC.IO.Encoding.Iconv &lt;entire-module&gt;             70          0    0.0    0.0     0.0    0.0
 CAF            GHC.Event.EPoll       &lt;entire-module&gt;             64          0    0.0    0.0     0.0    0.0
 main           Main                  app/Main.hs:(23,1)-(28,33)  93          0    0.0    0.0     0.0    0.0
</pre>
</div></li>
</ol>
</div>

<div id="outline-container-orgdca3328" class="outline-4">
<h4 id="orgdca3328"><span class="section-number-4">13.2.1</span> Još neke <i>RTS</i> (<i>Run Time System</i>) opcije</h4>
<div class="outline-text-4" id="text-13-2-1">
<p>
Ako programu od <a href="#org5287062">ranije</a> pro pokretanju prosledimo opciju <code>-pa</code>
dobićemo širi izveštaj o korišćenju resursa koji će obuhvatati i
podatke o alokaciji memorije:
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 5: </span>haskellNTP/profiling/profiling-exe-pa.prof</label><pre class="src src-fundamental">        Mon Mar  6 15:27 2017 Time and Allocation Profiling Report  (Final)

           profiling-exe +RTS -N -pa -RTS

        total time  =        0.58 secs   (577 ticks @ 1000 us, 1 processor)
        total alloc = 384,115,072 bytes  (excludes profiling overheads)

COST CENTRE  MODULE                  SRC                         %time %alloc  ticks     bytes

GC           GC                      &lt;built-in&gt;                   72.3    0.0    417         0
main.ys      Main                    app/Main.hs:28:17-33          9.4   37.5     54 144000016
last_init_ys Main                    app/Main.hs:26:44-57          6.4   29.2     37 111999960
main.xs      Main                    app/Main.hs:27:17-33          5.4   18.7     31  72000016
last_init_xs Main                    app/Main.hs:24:44-57          3.6   14.6     21  55999960
last_ys      Main                    app/Main.hs:25:39-45          1.0    0.0      6        16
last_xs      Main                    app/Main.hs:23:39-45          1.0    0.0      6        16
SYSTEM       SYSTEM                  &lt;built-in&gt;                    0.9    0.0      5     35728
IDLE         IDLE                    &lt;built-in&gt;                    0.0    0.0      0         0
PINNED       SYSTEM                  &lt;built-in&gt;                    0.0    0.0      0         0
DONT_CARE    MAIN                    &lt;built-in&gt;                    0.0    0.0      0         0
OVERHEAD_of  PROFILING               &lt;built-in&gt;                    0.0    0.0      0         0
MAIN         MAIN                    &lt;built-in&gt;                    0.0    0.0      0     22824
CAF          GHC.Integer.Type        &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.Err                 &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.Enum                &lt;entire-module&gt;               0.0    0.0      0         0
CAF          Foreign.Marshal.Alloc   &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.Event.PSQ           &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.Event.Manager       &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.Event.Array         &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.Stack.CCS           &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.IO.Encoding.UTF32   &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.IO.Encoding.Latin1  &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.Event.TimerManager  &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.Event.EPoll         &lt;entire-module&gt;               0.0    0.0      0        48
CAF          GHC.Show                &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.IO.Handle.Types     &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.IO.FD               &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.IO.Encoding.UTF8    &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.IO.Encoding.UTF16   &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.IO.Encoding.Iconv   &lt;entire-module&gt;               0.0    0.0      0       232
CAF          GHC.IO.Encoding.Failure &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.Exception           &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.Arr                 &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.Event.Poll          &lt;entire-module&gt;               0.0    0.0      0        96
CAF          GHC.Event.Internal      &lt;entire-module&gt;               0.0    0.0      0         0
CAF          System.Posix.Internals  &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.IO.Handle.Internals &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.IO.Handle           &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.ForeignPtr          &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.Conc.Sync           &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.Conc.Signal         &lt;entire-module&gt;               0.0    0.0      0       640
CAF          GHC.Event.Control       &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.List                &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.IO.Handle.Text      &lt;entire-module&gt;               0.0    0.0      0        88
CAF          GHC.IO.Encoding         &lt;entire-module&gt;               0.0    0.0      0      2872
CAF          GHC.Event.Thread        &lt;entire-module&gt;               0.0    0.0      0      1232
CAF          GHC.TopHandler          &lt;entire-module&gt;               0.0    0.0      0         0
CAF          GHC.IO.Handle.FD        &lt;entire-module&gt;               0.0    0.0      0     34512
CAF          GHC.IO.Exception        &lt;entire-module&gt;               0.0    0.0      0         0
CAF          Control.Exception.Base  &lt;entire-module&gt;               0.0    0.0      0         0
main         Main                    app/Main.hs:(23,1)-(28,33)    0.0    0.0      0     16800
CAF          Main                    &lt;entire-module&gt;               0.0    0.0      0        16


                                                                                      individual      inherited
COST CENTRE     MODULE                  SRC                        no.     entries  %time %alloc   %time %alloc  ticks     bytes

MAIN            MAIN                    &lt;built-in&gt;                  46          0    0.0    0.0   100.0  100.0      0     22824
 CAF            Main                    &lt;entire-module&gt;             91          0    0.0    0.0    26.9  100.0      0        16
  main          Main                    app/Main.hs:(23,1)-(28,33)  92          1    0.0    0.0    26.9  100.0      0      1208
   last_init_xs Main                    app/Main.hs:24:44-57        96          1    3.6   14.6     3.6   14.6     21  55999960
   last_init_ys Main                    app/Main.hs:26:44-57        99          1    6.4   29.2     6.4   29.2     37 111999960
   last_xs      Main                    app/Main.hs:23:39-45        94          1    1.0    0.0     1.0    0.0      6        16
   last_ys      Main                    app/Main.hs:25:39-45        97          1    1.0    0.0     1.0    0.0      6        16
   main.xs      Main                    app/Main.hs:27:17-33        95          1    5.4   18.7     5.4   18.7     31  72000016
   main.ys      Main                    app/Main.hs:28:17-33        98          1    9.4   37.5     9.4   37.5     54 144000016
 CAF            Control.Exception.Base  &lt;entire-module&gt;             90          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.IO.Exception        &lt;entire-module&gt;             89          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.IO.Handle.FD        &lt;entire-module&gt;             88          0    0.0    0.0     0.0    0.0      0     34512
 CAF            GHC.TopHandler          &lt;entire-module&gt;             87          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.Event.Thread        &lt;entire-module&gt;             86          0    0.0    0.0     0.0    0.0      0      1232
 CAF            GHC.IO.Encoding         &lt;entire-module&gt;             85          0    0.0    0.0     0.0    0.0      0      2872
 CAF            GHC.IO.Handle.Text      &lt;entire-module&gt;             84          0    0.0    0.0     0.0    0.0      0        88
 CAF            GHC.List                &lt;entire-module&gt;             83          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.Event.Control       &lt;entire-module&gt;             82          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.Conc.Signal         &lt;entire-module&gt;             81          0    0.0    0.0     0.0    0.0      0       640
 CAF            GHC.Conc.Sync           &lt;entire-module&gt;             80          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.ForeignPtr          &lt;entire-module&gt;             79          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.IO.Handle           &lt;entire-module&gt;             78          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.IO.Handle.Internals &lt;entire-module&gt;             77          0    0.0    0.0     0.0    0.0      0         0
 CAF            System.Posix.Internals  &lt;entire-module&gt;             76          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.Event.Internal      &lt;entire-module&gt;             75          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.Event.Poll          &lt;entire-module&gt;             74          0    0.0    0.0     0.0    0.0      0        96
 CAF            GHC.Arr                 &lt;entire-module&gt;             73          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.Exception           &lt;entire-module&gt;             72          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.IO.Encoding.Failure &lt;entire-module&gt;             71          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.IO.Encoding.Iconv   &lt;entire-module&gt;             70          0    0.0    0.0     0.0    0.0      0       232
 CAF            GHC.IO.Encoding.UTF16   &lt;entire-module&gt;             69          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.IO.Encoding.UTF8    &lt;entire-module&gt;             68          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.IO.FD               &lt;entire-module&gt;             67          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.IO.Handle.Types     &lt;entire-module&gt;             66          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.Show                &lt;entire-module&gt;             65          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.Event.EPoll         &lt;entire-module&gt;             64          0    0.0    0.0     0.0    0.0      0        48
 CAF            GHC.Event.TimerManager  &lt;entire-module&gt;             63          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.IO.Encoding.Latin1  &lt;entire-module&gt;             62          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.IO.Encoding.UTF32   &lt;entire-module&gt;             61          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.Stack.CCS           &lt;entire-module&gt;             60          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.Event.Array         &lt;entire-module&gt;             59          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.Event.Manager       &lt;entire-module&gt;             58          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.Event.PSQ           &lt;entire-module&gt;             57          0    0.0    0.0     0.0    0.0      0         0
 CAF            Foreign.Marshal.Alloc   &lt;entire-module&gt;             56          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.Enum                &lt;entire-module&gt;             55          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.Err                 &lt;entire-module&gt;             54          0    0.0    0.0     0.0    0.0      0         0
 CAF            GHC.Integer.Type        &lt;entire-module&gt;             53          0    0.0    0.0     0.0    0.0      0         0
 DONT_CARE      MAIN                    &lt;built-in&gt;                  49          0    0.0    0.0     0.0    0.0      0         0
 GC             GC                      &lt;built-in&gt;                  51          0   72.3    0.0    72.3    0.0    417         0
 IDLE           IDLE                    &lt;built-in&gt;                  47          0    0.0    0.0     0.0    0.0      0         0
 OVERHEAD_of    PROFILING               &lt;built-in&gt;                  50          0    0.0    0.0     0.0    0.0      0         0
 PINNED         SYSTEM                  &lt;built-in&gt;                  48          0    0.0    0.0     0.0    0.0      0         0
 SYSTEM         SYSTEM                  &lt;built-in&gt;                  52          0    0.9    0.0     0.9    0.0      5     35728
 main           Main                    app/Main.hs:(23,1)-(28,33)  93          0    0.0    0.0     0.0    0.0      0     15592
</pre>
</div>

<p>
Listu ostalih opcija možete pogledati <a href="https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/profiling.html#time-and-allocation-profiling">ovde</a>.
</p>
</div>
</div>

<div id="outline-container-org6afdf56" class="outline-4">
<h4 id="org6afdf56"><span class="section-number-4">13.2.2</span> Potrošnja memorije kroz vreme</h4>
<div class="outline-text-4" id="text-13-2-2">
<p>
Ponekada je korisno pratiti i potrošnju memorije kroz
vreme. Ovakvi izveštaji mogu lepo pokazati kojom dinamikom dolazi
do <i>out of memory</i> grešaka i zašto.
</p>

<p>
Kako bismo pokrenuli program tako da dobijemo <i>heap</i> profil
potrebno je da koristimo <i>RTS</i> opciju <code>-h</code> (ili neku drugu opciju
koja nam omogućuje inspekciju korišćenja <i>heap</i>-a, a puna lista je
data <a href="https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/profiling.html#rts-options-for-heap-profiling">ovde</a>). I nakon toga dobijamo fajl <code>program.hp</code> u kome se
nalaze merenja koja liče na:
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 6: </span>haskellNTP/profiling/profiling-exe-basic.hp</label><pre class="src src-fundamental">JOB <span style="color: #CC9393;">"profiling-exe +RTS -N -h"</span>
DATE <span style="color: #CC9393;">"Mon Mar  6 15:38 2017"</span>
SAMPLE_UNIT <span style="color: #CC9393;">"seconds"</span>
VALUE_UNIT <span style="color: #CC9393;">"bytes"</span>
BEGIN_SAMPLE 0.000000
END_SAMPLE 0.000000
BEGIN_SAMPLE 0.200000
(48)PINNED      32720
(81)GHC.Conc.Signal.CAF 640
(88)GHC.IO.Handle.FD.CAF        680
(84)GHC.IO.Handle.Text.CAF      24
(93)main        144
(91)Main.CAF    48
MAIN    9960
(74)GHC.Event.Poll.CAF  24
(86)GHC.Event.Thread.CAF        560
(70)GHC.IO.Encoding.Iconv.CAF   120
(85)GHC.IO.Encoding.CAF 1168
(98)main.ys/main/Main.CAF       56795872
END_SAMPLE 0.200000
BEGIN_SAMPLE 0.272000
END_SAMPLE 0.272000
</pre>
</div>

<p>
za vizualizaciju ovih rezultata može se koristiti program <code>hp2ps</code>:
</p>

<div class="org-src-container">
<pre class="src src-shell">stack exec -- hp2ps -d program-exe.hp
</pre>
</div>

<p>
Za program:
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 7: </span>haskellNTP/profiling/src/Mean.hs</label><pre class="src src-haskell"><span style="color: #F0DFAF; font-weight: bold;">import</span>           <span style="color: #7CB8BB;">System.Environment</span>
<span style="color: #F0DFAF; font-weight: bold;">import</span>           <span style="color: #7CB8BB;">Text.Printf</span>

<span style="color: #93E0E3;">meanMain</span> <span style="color: #DFAF8F;">=</span> <span style="color: #F0DFAF; font-weight: bold;">do</span> [d] <span style="color: #DFAF8F;">&lt;-</span> map read <span style="color: #DFAF8F;">`fmap`</span> getArgs
              printf <span style="color: #CC9393;">"%f\n"</span> (mean [1 <span style="color: #DFAF8F;">..</span> d])

<span style="color: #93E0E3;">mean</span> <span style="color: #DFAF8F;">::</span> [<span style="color: #7CB8BB;">Double</span>] <span style="color: #DFAF8F;">-&gt;</span> <span style="color: #7CB8BB;">Double</span>
<span style="color: #93E0E3;">mean</span> xs <span style="color: #DFAF8F;">=</span> sum xs <span style="color: #DFAF8F;">/</span> fromIntegral (length xs)
</pre>
</div>


<div class="figure">
<p><img src="images/profiling-exe-mean.jpg" alt="profiling-exe-mean.jpg" width="600px" />
</p>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orgdd5b6bd" class="outline-2">
<h2 id="orgdd5b6bd"><span class="section-number-2">14</span> Haskell Core&#xa0;&#xa0;&#xa0;<span class="tag"><span class="za_radoznale">za_radoznale</span></span></h2>
<div class="outline-text-2" id="text-14">
<p>
Kada <i>profiling</i> ne daje dovoljno dobar uvid u to šta program radi
na niskim nivoima onda možda razumevanja <i>Haskell Core-a</i> može da
pomogne.
</p>

<p>
<a href="https://ghc.haskell.org/trac/ghc/wiki/Commentary/Compiler/CoreSynType"><i>Haskell Core</i></a> je "jednostavan funkcionalan jezik" koji <i>GHC</i>
koristi kao <i>intermediate</i> reprezentaciju programa. <i>GHC</i> optimizuje
programe tako što ih sukcesivno transformiše u sve efikasnije
forme. <i>Core</i> predstavlja poslednji nivo na kome se očuvavaju
pravila funkcionalnog programiranja pre prevođenja na imperativni -
kod niskog nivoa (za šta se kod <i>GHC</i>-a koriste <a href="https://ghc.haskell.org/trac/ghc/wiki/Commentary/Compiler/GeneratedCode"><i>STG</i></a> i <i>C--</i>).
</p>

<p>
<i>Core</i> je za razliku od Haskell-a veoma jednostavan jezik. Njegova
sintaksa se može opisati u 20-ak linija, eksplicitno je tipiziran. I
<i>sve konstrukcije u Haskell-u mogu se predstaviti pomoću Core
jezika</i>.
</p>

<p>
Kako bismo od kompajlera tržili da nam pokaže <i>Core</i> verziju našeg
programa treba da mu prosledimo opciju <code>-ddump-simpl</code> ili da
koristimo <code>ghc-core</code> alat koji to (uz još par stvari) uradi za
nas. Ako projekat koristi <i>Stack</i> onda se to može uratiti na sledeći
način:
</p>

<p>
Instalirati <code>ghc-core</code>:
</p>

<div class="org-src-container">
<pre class="src src-shell">stack install ghc-core
</pre>
</div>

<p>
<i>Stack</i> će možda upozoriti da nema specificiranih verzija
<i>dependencies</i>-a ali će dati i predlog šta treba uraditi, npr:
</p>

<div class="org-src-container">
<pre class="src src-fundamental">Recommended action: try adding the following to your extra-deps in
/.../haskellNTP/profiling/stack.yaml:
- colorize-haskell-1.0.1
</pre>
</div>

<p>
Poslušaćemo predlog i izmeniti odgovarajuću liniju u <code>stack.yaml</code>
projekta na:
</p>

<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #DFAF8F;">extra-deps</span>: [colorize-haskell-1.0.1]
</pre>
</div>

<p>
Nakon toga možemo ponovo pokrenuti instalaciju i posle toga:
</p>

<div class="org-src-container">
<pre class="src src-shell">stack exec -- ghc-core app/Main.hs
</pre>
</div>

<p>
Što će na terminal ispisati sve transformacije našeg programa pa
tako možemo ispratiti šta tačno radi kompajler.
</p>

<p>
<i>GHC</i> nam omogućuje da ispitujemo sve njegove nivoe kompajliranja pa
tako i sam asembler na kraju. O tome možete čitati na kraju <a href="http://book.realworldhaskell.org/read/profiling-and-optimization.html">ovog</a>
poglavlja <i>Real World Haskell</i>-a.
</p>
</div>
</div>
<div id="outline-container-orgd0656cc" class="outline-2">
<h2 id="orgd0656cc"><span class="section-number-2">15</span> Literatura</h2>
<div class="outline-text-2" id="text-15">
<ul class="org-ul">
<li><a href="http://learnyouahaskell.com/">Learn Some Haskell For The Great Good</a></li>
<li><a href="https://wiki.haskell.org/Introduction">Haskell wiki</a></li>
<li><a href="http://book.realworldhaskell.org/">Real World Haskell</a> (odlična knjiga ali nije davno ažurirana)</li>
<li><a href="http://www.seas.upenn.edu/~cis194/">Kursevi na Pensilvanija univerzitetu</a> (<i>spring13</i>, <i>fall16</i> ili
bilo koji drugi po izboru.)</li>
</ul>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
Ovaj deo je uglavnom preuzet sa <a href="http://www.seas.upenn.edu/~cis194/spring13/lectures/01-intro.html">cis194</a> (koji svakako
preporučujem u celini :) ).
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2">2</a></sup> <div class="footpara"><p class="footpara">
Naravno, sve se može ako je čovek dovoljno uporan, samo nije
uvek najpametnije.
</p></div></div>

<div class="footdef"><sup><a id="fn.3" class="footnum" href="#fnr.3">3</a></sup> <div class="footpara"><p class="footpara">
Izrazi koji imaju sporedne efekte se <span class="underline">veoma</span> posebno tretiraju.
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: Novak Boškov</p>
<p class="date">Created: 2017-05-25 чет 13:24</p>
<p class="validation"></p>
</div>
</body>
</html>
